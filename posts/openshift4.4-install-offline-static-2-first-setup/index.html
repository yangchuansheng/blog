<!doctype html><html lang=zh-cn dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Openshift 4.4 静态 IP 离线安装系列：初始安装 &#183; 云原生实验室</title>
<meta name=title content="Openshift 4.4 静态 IP 离线安装系列：初始安装 &#183; 云原生实验室"><meta name=description content="本文开始正式安装 OCP（Openshift Container Platform） 集群，包括 DNS 解析、负载均衡配置、ignition 配置文件生成和集群部署。"><meta name=keywords content="Openshift,"><link rel=canonical href=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/><link type=text/css rel=stylesheet href=/css/main.bundle.min.b7fb0c9f741eec29bdb0a6164e6fb98142379f157dae2a7ed94211d17a1be86e33aa6c7385e9bfcff8745f8aa4132b40bf3ce8189fb66c7b61a657f8bba3c5ad.css integrity="sha512-t/sMn3Qe7Cm9sKYWTm+5gUI3nxV9rip+2UIR0Xob6G4zqmxzhem/z/h0X4qkEytAvzzoGJ+2bHthplf4u6PFrQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.829f642301e982d157769b6448ba4e0d2d54933c6013c25f18def451433c762b8e8def22a1c6a2edd6f3fcbaa4c110aef5255aa8461e6d7e06acc035db4867c3.js integrity="sha512-gp9kIwHpgtFXdptkSLpODS1UkzxgE8JfGN70UUM8diuOje8iocai7dbz/LqkwRCu9SVaqEYebX4GrMA120hnww==" data-copy data-copied></script><script src=/js/zoom.min.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Openshift 4.4 静态 IP 离线安装系列：初始安装"><meta property="og:description" content="本文开始正式安装 OCP（Openshift Container Platform） 集群，包括 DNS 解析、负载均衡配置、ignition 配置文件生成和集群部署。"><meta property="og:type" content="article"><meta property="og:url" content="https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/"><meta property="og:image" content="https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/featured.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-02T18:40:45+08:00"><meta property="article:modified_time" content="2020-06-02T18:40:45+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/featured.jpg"><meta name=twitter:title content="Openshift 4.4 静态 IP 离线安装系列：初始安装"><meta name=twitter:description content="本文开始正式安装 OCP（Openshift Container Platform） 集群，包括 DNS 解析、负载均衡配置、ignition 配置文件生成和集群部署。"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"博客","name":"Openshift 4.4 静态 IP 离线安装系列：初始安装","headline":"Openshift 4.4 静态 IP 离线安装系列：初始安装","description":"本文开始正式安装 OCP（Openshift Container Platform） 集群，包括 DNS 解析、负载均衡配置、ignition 配置文件生成和集群部署。","abstract":"上篇文章准备了离线安装 OCP 所需要的离线资源，包括安装镜像、所有","inLanguage":"zh-cn","url":"https:\/\/icloudnative.io\/posts\/openshift4.4-install-offline-static-2-first-setup\/","author":{"@type":"Person","name":"米开朗基杨"},"copyrightYear":"2020","dateCreated":"2020-06-02T18:40:45\u002b08:00","datePublished":"2020-06-02T18:40:45\u002b08:00","dateModified":"2020-06-02T18:40:45\u002b08:00","keywords":["openshift","ocp","openshift4","ocp4","quay"],"mainEntityOfPage":"true","wordCount":"6665"}]</script><meta name=author content="米开朗基杨"><link href=/index.xml rel=me><link href=https://twitter.com/CarsonYangk8s rel=me><link href=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/tmpm1ykjt96.webp rel=me><link href=https://github.com/yangchuansheng rel=me><link href=https://t.me/cloudnativer rel=me><script src=/lib/jquery/jquery.slim.min.js integrity></script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.createElement("link");e.href="https://jsd.onmicrosoft.cn/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css",e.rel="stylesheet",document.head.appendChild(e)})</script><div id=fps style=z-index:999;position:fixed;bottom:3px;right:3px;color:#fff;font-size:10px></div><script defer type=text/javascript src=https://cdn.staticfile.org/layer/3.5.1/layer.min.js></script><script defer type=text/javascript src=https://icloudnative.io/js/fps.js></script><script>window.addEventListener("scroll",function e(){window.scrollY>100&&(function(e,t,n,s){if(typeof e.webpushr!="undefined")return;e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var i=t.getElementsByTagName(n)[0],o=t.createElement(n);o.id=s,o.async=1,o.src="https://cdn.webpushr.com/app.min.js",i.parentNode.appendChild(o)}(window,document,"script","webpushr-jssdk"),webpushr("setup",{key:"BHIaDYldZcXlQt38kYXgH48NQZFQkowuo14rNhiIvrGEP5kFU5lb5h-VIMlUkjy-kxygxW4hEvb6GjijlYYlwCk"}),window.removeEventListener("scroll",e))})</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?efe96f04908ae320df234a4f5626879e",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src=https://umami.icloudnative.io/oishii data-website-id=f415abb1-1cb9-402e-a1c4-225ca9d792b0></script><script async src="https://eezgfvhagnzs.cloud.sealos.io/gtag/js?id=G-0VHVXWXJMQ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0VHVXWXJMQ")</script><div class=top-scroll-bar style=height:5px;background-color:blue;width:0;position:fixed;top:0;z-index:100></div><script type=text/javascript>$(document).ready(function(){$(window).scroll(function(){$(".top-scroll-bar").attr("style","width: "+$(this).scrollTop()/($(document).height()-$(this).height())*100+"%; display: block;")})})</script><script src=https://jsd.onmicrosoft.cn/gh/instantpage/instant.page@master/instantpage.js type=module></script><script type=text/javascript>var OriginTitile=document.title,titleTime;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="你别走吖 Σ(っ °Д °;)っ",clearTimeout(titleTime)):(document.title="你可算回来了 (｡•ˇ‸ˇ•｡)"+OriginTitile,titleTime=setTimeout(function(){document.title=OriginTitile},2e3))})</script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span></a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><img src=/img/logo.webp width=256 height=256 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=云原生实验室></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900"><h6 style=font-size:1.5rem><span style=color:#23d18b>>$</span>&nbsp;cd /home/<span class=logo_cursor></span></h6></a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/examples/ class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=开源项目>项目</p></a><a href="https://umami.icloudnative.io/share/UuDHNJJWIShegM2N/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4?theme=dark" target=_blank class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span><p class="text-base font-medium text-gray-500 hover:text-gray-900" title>实时访客</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M159.3 5.4c7.8-7.3 19.9-7.2 27.7.1 27.6 25.9 53.5 53.8 77.7 84 11-14.4 23.5-30.1 37-42.9 7.9-7.4 20.1-7.4 28 .1 34.6 33 63.9 76.6 84.5 118 20.3 40.8 33.8 82.5 33.8 111.9C448 404.2 348.2 512 224 512 98.4 512 0 404.1.0 276.5c0-38.4 17.8-85.3 45.4-131.7C73.3 97.7 112.7 48.6 159.3 5.4zM225.7 416c25.3.0 47.7-7 68.8-21 42.1-29.4 53.4-88.2 28.1-134.4-2.8-5.6-5.6-11.2-9.8-16.8l-50.6 58.8S180.8 199 175.1 192c-42 51.8-63.1 81.2-63.1 114.8C112 375.4 162.6 416 225.7 416z"/></svg></span></span><a class="text-base font-medium text-gray-500 hover:text-gray-900" title>百宝箱
</a><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=https://icloudnative.io/uptime-status/ target=_blank class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M228.3 469.1 47.6 300.4c-4.2-3.9-8.2-8.1-11.9-12.4h87c22.6.0 43-13.6 51.7-34.5l10.5-25.2 49.3 109.5c3.8 8.5 12.1 14 21.4 14.1s17.8-5 22-13.3L320 253.7l1.7 3.4c9.5 19 28.9 31 50.1 31H476.3c-3.7 4.3-7.7 8.5-11.9 12.4L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9s-20.2-3.9-27.7-10.9zM503.7 240h-132c-3 0-5.8-1.7-7.2-4.4l-23.2-46.3c-4.1-8.1-12.4-13.3-21.5-13.3s-17.4 5.1-21.5 13.3l-41.4 82.8-51-113.9c-3.9-8.7-12.7-14.3-22.2-14.1s-18.1 5.9-21.8 14.8l-31.8 76.3c-1.2 3-4.2 4.9-7.4 4.9H16c-2.6.0-5 .4-7.3 1.1-5.7-16-8.7-33-8.7-50.3v-5.8c0-69.9 50.5-129.5 119.4-141C165 36.5 211.4 51.4 244 84l12 12 12-12c32.6-32.6 79-47.5 124.6-39.9C461.5 55.6 512 115.2 512 185.1v5.8c0 16.9-2.8 33.5-8.3 49.1z"/></svg></span></span><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title>服务监控</p></a><a href=https://privatebin.icloudnative.io/ target=_blank class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M160 0c-23.7.0-44.4 12.9-55.4 32H48C21.5 32 0 53.5.0 80V4e2c0 26.5 21.5 48 48 48H192V176c0-44.2 35.8-80 80-80h48V80c0-26.5-21.5-48-48-48H215.4C204.4 12.9 183.7.0 160 0zM272 128c-26.5.0-48 21.5-48 48V448v16c0 26.5 21.5 48 48 48H464c26.5.0 48-21.5 48-48V256H416c-17.7.0-32-14.3-32-32V128H320 272zM160 40a24 24 0 110 48 24 24 0 110-48zm256 88v96h96l-96-96z"/></svg></span></span><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title>共享文本</p></a><a href=/jstc/ class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M0 96C0 60.7 28.7 32 64 32H448c35.3.0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3.0-64-28.7-64-64V96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4S78.8 416 88 416h96 32H424c8.9.0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192c26.5.0 48-21.5 48-48s-21.5-48-48-48-48 21.5-48 48 21.5 48 48 48z"/></svg></span></span><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title>趣味截图</p></a></div></div></div></div><a href=/index.xml class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=rss></p></a><a href=https://twitter.com/CarsonYangk8s target=_blank class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=twitter></p></a><a href=https://github.com/yangchuansheng target=_blank class="flex items-center"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=github></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/examples/ class="flex items-center"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=开源项目>项目</p></a></li><li class=mt-1><a href="https://umami.icloudnative.io/share/UuDHNJJWIShegM2N/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4?theme=dark" target=_blank class="flex items-center"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></div><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title>实时访客</p></a></li><li class=mt-1><a class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M159.3 5.4c7.8-7.3 19.9-7.2 27.7.1 27.6 25.9 53.5 53.8 77.7 84 11-14.4 23.5-30.1 37-42.9 7.9-7.4 20.1-7.4 28 .1 34.6 33 63.9 76.6 84.5 118 20.3 40.8 33.8 82.5 33.8 111.9C448 404.2 348.2 512 224 512 98.4 512 0 404.1.0 276.5c0-38.4 17.8-85.3 45.4-131.7C73.3 97.7 112.7 48.6 159.3 5.4zM225.7 416c25.3.0 47.7-7 68.8-21 42.1-29.4 53.4-88.2 28.1-134.4-2.8-5.6-5.6-11.2-9.8-16.8l-50.6 58.8S180.8 199 175.1 192c-42 51.8-63.1 81.2-63.1 114.8C112 375.4 162.6 416 225.7 416z"/></svg></span></span><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title>百宝箱</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=https://icloudnative.io/uptime-status/ target=_blank class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M228.3 469.1 47.6 300.4c-4.2-3.9-8.2-8.1-11.9-12.4h87c22.6.0 43-13.6 51.7-34.5l10.5-25.2 49.3 109.5c3.8 8.5 12.1 14 21.4 14.1s17.8-5 22-13.3L320 253.7l1.7 3.4c9.5 19 28.9 31 50.1 31H476.3c-3.7 4.3-7.7 8.5-11.9 12.4L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9s-20.2-3.9-27.7-10.9zM503.7 240h-132c-3 0-5.8-1.7-7.2-4.4l-23.2-46.3c-4.1-8.1-12.4-13.3-21.5-13.3s-17.4 5.1-21.5 13.3l-41.4 82.8-51-113.9c-3.9-8.7-12.7-14.3-22.2-14.1s-18.1 5.9-21.8 14.8l-31.8 76.3c-1.2 3-4.2 4.9-7.4 4.9H16c-2.6.0-5 .4-7.3 1.1-5.7-16-8.7-33-8.7-50.3v-5.8c0-69.9 50.5-129.5 119.4-141C165 36.5 211.4 51.4 244 84l12 12 12-12c32.6-32.6 79-47.5 124.6-39.9C461.5 55.6 512 115.2 512 185.1v5.8c0 16.9-2.8 33.5-8.3 49.1z"/></svg></span></span><p class="text-sm font-small text-gray-500 hover:text-gray-900" title>服务监控</p></a></li><li class=mt-1><a href=https://privatebin.icloudnative.io/ target=_blank class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M160 0c-23.7.0-44.4 12.9-55.4 32H48C21.5 32 0 53.5.0 80V4e2c0 26.5 21.5 48 48 48H192V176c0-44.2 35.8-80 80-80h48V80c0-26.5-21.5-48-48-48H215.4C204.4 12.9 183.7.0 160 0zM272 128c-26.5.0-48 21.5-48 48V448v16c0 26.5 21.5 48 48 48H464c26.5.0 48-21.5 48-48V256H416c-17.7.0-32-14.3-32-32V128H320 272zM160 40a24 24 0 110 48 24 24 0 110-48zm256 88v96h96l-96-96z"/></svg></span></span><p class="text-sm font-small text-gray-500 hover:text-gray-900" title>共享文本</p></a></li><li class=mt-1><a href=/jstc/ class="flex items-center"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M0 96C0 60.7 28.7 32 64 32H448c35.3.0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3.0-64-28.7-64-64V96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4S78.8 416 88 416h96 32H424c8.9.0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192c26.5.0 48-21.5 48-48s-21.5-48-48-48-48 21.5-48 48 21.5 48 48 48z"/></svg></span></span><p class="text-sm font-small text-gray-500 hover:text-gray-900" title>趣味截图</p></a></li><li class=mb-2></li><li class=mt-1><a href=/index.xml class="flex items-center"><div><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></div><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=rss></p></a></li><li class=mt-1><a href=https://twitter.com/CarsonYangk8s target=_blank class="flex items-center"><div><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></div><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=twitter></p></a></li><li class=mt-1><a href=https://github.com/yangchuansheng target=_blank class="flex items-center"><div><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=github></p></a></li></ul></div></label></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><div class=wrapper__left style=left:2px data-pad=true dir=ltr><div class="join-us dark:text-black" style=margin-top:3%;height:39%><img class=modalImage style=max-width:13% src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/2023-03-01-22-59-x40tuN.png alt=icon></img><p><a data-umami-event=Sealos href=https://github.com/labring/sealos target=_blank>Sealos</a>，在云桌面中运行分布式应用程序，像使用个人电脑一样使用云</p><img class=modalImage style=max-width:92% src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/2023-08-31-09-52-gLmSek.jpg alt=icon></img><p style=margin-top:1rem!important;text-align:center><a data-umami-event=Sealos class="!rounded-md bg-primary-600 px-4 py-2 !text-neutral !no-underline hover:!bg-primary-500 dark:bg-primary-800 dark:hover:!bg-primary-700" href=https://sealos.run target=_blank role=button>去看看👀</a></p></div><div class=join-us style=top:42%;height:53%><img class="modalImage nozoom" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@three/img/modal-content.svg alt=icon></img><p>扫码加入微信群，和云原生大佬们一起探讨云原生和不可描述的事情！</p><div><img style=width:88px;margin-top:2% src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/tmpm1ykjt96.webp></img></div><button class=button_left>
<a data-umami-event="Telegram cloud_native_share" href=https://t.me/cloudnativer target=_blank><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>加入 Telegram</p></button>
<button class=button_left>
<a data-umami-event="Telegram cloud_native_share" href=https://t.me/cloud_native_share target=_blank><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>黑科技广播站</p></button>
<button class=button_left>
<a data-umami-event="Telegram cloud_native_blogs" href=https://t.me/cloud_native_blogs target=_blank><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>高手博客收藏夹</p></button></div></div><div class=wrapper__right style=right:2px data-pad=true dir=ltr><div class="join-us dark:text-black" style=margin-top:3%;height:34%><svg style="display:inline-block" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor"><path d="M773.12 757.76h-79.872c-15.36.0-29.696-15.36-29.696-29.696s15.36-29.696 29.696-29.696h79.872c100.352.0 180.224-79.872 180.224-180.224S873.472 337.92 773.12 337.92c-25.6.0-50.176 5.12-74.752 15.36-10.24 5.12-20.48 5.12-25.6.0-10.24-5.12-15.36-15.36-15.36-20.48-15.36-100.352-100.352-175.104-200.704-175.104C346.112 155.648 256 245.76 250.88 356.352c0 15.36-10.24 29.696-29.696 29.696-79.872 5.12-145.408 74.752-145.408 160.768.0 90.112 70.656 160.768 160.768 160.768h75.776c15.36.0 29.696 15.36 29.696 29.696S326.656 768 311.296 768h-79.872C110.592 757.76 10.24 662.528 10.24 541.696c0-105.472 75.776-195.584 175.104-216.064 15.36-130.048 130.048-235.52 266.24-235.52 120.832.0 225.28 79.872 256 195.584 20.48-5.12 45.056-10.24 65.536-10.24 135.168 1.024 240.64 111.616 240.64 241.664S903.168 757.76 773.12 757.76z"/><path d="M437.248 933.888c-10.24.0-15.36-5.12-20.48-10.24-10.24-10.24-10.24-29.696.0-45.056l79.872-79.872h-60.416c-10.24.0-25.6-5.12-29.696-20.48-5.12-10.24.0-24.576 5.12-34.816l130.048-130.048c10.24-10.24 29.696-10.24 45.056.0 10.24 10.24 10.24 29.696.0 45.056L512 742.4h55.296c10.24.0 24.576 5.12 29.696 20.48 5.12 10.24.0 24.576-5.12 34.816L461.824 928.768c-10.24 5.12-20.48 5.12-24.576 5.12z"/></svg>&nbsp;<div class=modalImage style=font-size:1.125rem!important><span>今日天气</span></div><div id=he-plugin-standard></div></div><script>WIDGET={CONFIG:{layout:"2",width:"290",height:"270",background:"3",dataColor:"FFFFFF",borderRadius:"5",key:"ea8d62655f2d45c5b34f5efdbec2fa8a"}}</script><script defer src="https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0"></script><div id=tiangou class="join-us dark:text-black" style=top:36%><svg style="display:inline-block" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor"><path d="M774.144 734.72c-35.328 60.416-99.84 93.696-176.64 74.752-1.024 29.696-12.288 54.784-36.352 72.704-15.36 11.264-33.28 16.896-51.712 15.872-47.616-1.536-75.264-30.72-85.504-88.064-74.752 15.36-132.608-8.704-173.056-72.192-17.92 3.584-35.84 9.216-53.76 10.752-63.488 5.12-107.52-28.16-122.88-90.112-12.288-49.152-7.68-98.816 5.12-146.944 34.304-130.048 102.4-238.08 213.504-315.392 146.944-102.912 333.312-93.184 471.552 24.576C865.792 307.2 928.768 416.768 952.832 547.84c6.144 34.816 6.656 70.144-1.024 104.96-20.48 94.72-100.864 110.592-166.4 86.016-3.584-.512-7.168-2.048-11.264-4.096zm-235.008-46.592c11.776 41.984 46.592 71.68 90.112 76.288 42.496 4.096 82.432-17.92 102.912-55.296 3.072-6.144 3.072-10.752.512-17.92-6.144-16.384-14.336-33.792-14.848-51.2-2.048-86.016-2.048-172.032-2.56-258.048.0-15.872 8.704-24.576 23.04-24.064 13.824.512 20.992 8.704 20.992 24.576l1.536 240.64c0 6.144.0 12.288.512 18.432 1.536 15.872 7.168 30.208 19.456 40.96 40.448 36.864 104.96 19.456 120.32-32.768 8.704-30.208 8.704-60.928 3.584-91.136-20.48-117.248-75.776-216.064-164.352-295.424-119.296-106.496-277.504-121.344-408.064-36.352-117.76 76.8-184.832 188.416-211.968 324.608-6.656 33.792-7.168 68.608 4.096 101.888 8.192 23.552 22.528 40.96 48.128 46.08 54.784 10.752 92.16-19.456 92.16-75.264V614.4c0-76.8.0-153.088.512-229.888.0-17.92 8.192-27.136 23.04-26.624 14.336.0 21.504 9.216 22.016 26.624.0 12.8-.512 25.6-.512 37.888.0 69.12-.512 138.24-.512 207.36.0 22.528-5.12 43.52-16.384 63.488-2.048 4.096-2.56 11.264-.512 15.36 29.696 59.904 111.104 75.264 160.768 30.72 16.384-14.848 28.16-32.256 32.256-50.688-14.336-13.312-26.624-25.088-39.424-36.864-15.36-14.336-17.92-31.744-12.288-50.688 5.632-19.968 19.456-33.792 39.424-35.84 25.6-2.56 51.712-2.048 77.312.0 19.456 1.536 32.256 15.36 38.4 33.792 5.632 16.896 5.632 33.792-7.168 47.616-11.776 14.336-26.624 26.624-42.496 41.472zm-50.176 85.504c-18.944 13.312-24.064 30.208-16.384 51.712 6.144 17.92 23.552 29.184 41.472 27.648 18.944-1.536 33.28-14.336 37.376-33.28 5.632-26.112 2.56-35.328-15.872-45.056-1.024 9.216-.512 18.944-2.56 27.648-2.56 10.24-11.264 14.848-21.504 14.848-15.36.512-19.968-8.192-22.528-43.52z"/><path d="M391.168 496.64c-20.992.0-37.376-16.896-36.864-37.376.512-20.48 17.92-36.864 38.4-36.352 19.968.512 35.84 16.896 35.84 37.376.512 20.48-15.872 36.352-37.376 36.352zm282.624-31.744c0 20.48-15.872 36.864-36.352 36.864-20.992.0-37.888-16.384-37.376-37.376.512-20.48 16.384-36.864 36.864-36.864 20.992-.512 36.864 15.872 36.864 37.376z"/></svg>&nbsp;<div class=modalImage style=font-size:1.125rem!important><span>舔狗日记</span></div><p id=apiData class="content type3"></p><div class=change><svg id="refreshButton" class="modalImage" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentcolor"><path d="M1000.61 625.5c-24.6-33.4-55.3-155.5-69.3-231.5-3.8-20.6-18.7-36.9-38.8-42.6-4-1.1-8.1-1.8-12.2-1.9-35.3-59-74.5-66.7-100.5-71.8-18.5-3.6-18.8-4.5-21.5-11.1-13.1-32.1-32.3-54-57.1-65.1-20.8-9.4-41.4-9.2-53.7-9.2-.9.0-2-.2-3.2-.5-.8-.2-1.6-.3-2.4-.4-39.3-56.7-70.7-68.1-108.5-68.1h-.2c-38.1.0-63 21-81.2 36.4l-1.6 1.4c-21.3 18-24.9 18.8-33.7 15.2-45.3-18.6-84.6-8.1-116.8 31-13.6 16.6-20.7 29-25.4 37.1l-.1.2c-5.1-.7-10.3-1.6-15.4-2.5-27.5-4.9-51.8 6.7-72.4 34.5-16.7 22.5-27.7 51.7-34.2 73.1-1.7-.2-3.3-.3-5-.3-27.1.0-50.4 20.3-54 47.2-5.5 39.8-15.3 87.4-26.2 127.3-13.4 48.9-27.5 83.2-40.8 99.3-27.6 33.4-28.7 66.5-24.7 88.4 6.7 37.3 34.9 73.7 75.5 97.3 55.3 32.2 158.1 92 447 92 268 0 356.3-52.2 414.8-86.8l2.2-1.3c2.3-1.4 4.5-2.7 6.8-4 18.6-10.8 63-41.6 73.8-93.3 4.4-21.8 4.5-55-21.2-90zM919.01 759c-3 1.8-6.1 3.6-9.3 5.5-27.1 16-60.7 35.9-118.5 51.5-67.9 18.3-155.2 27.2-266.9 27.2-273.4.0-367.5-54.8-418.1-84.2-20.2-11.8-43.4-33.1-47.8-57.7-2.6-14.5 1.6-28.5 12.5-41.6 22.3-27 42.5-78.2 60-152.3 10.3-43.7 16.6-82.8 18.8-97.2 28.9 25.2 104.2 42.6 148.1 51 73.8 14.1 161.6 22.5 234.9 22.5 68.4.0 140.7-7.1 203.7-20.1 62.7-12.9 110.4-30.4 134.6-49.3 1.9-.2 3.7-.6 5.5-1.2 7.7 39.5 39.9 194.9 77.8 246.5 10.6 14.4 14.3 29.2 11.2 44.2-4.3 20.1-21.7 40.8-46.5 55.2zm-271.3-509.5c23.2-.1 41.5-.2 57.3 38.6 14.8 36.3 44.2 42 63.7 45.9 18.9 3.7 38.5 7.6 59.3 40.1-15.5 9-49.3 21.8-101.4 32.7v-1c-1.7-55.7-39.4-82-61.3-88.7-7.3-2.3-15.1-1.5-21.9 2.1s-11.8 9.6-14.1 17c-4.7 15.2 3.9 31.3 19 35.9.8.3 19.9 6.8 20.7 35.5.1 3 .7 6 1.8 9-45.5 6.3-91.7 9.6-137.6 9.6h-.8c-68 0-150.1-7.7-219.4-20.6-60.1-11.2-93.1-22.8-108.5-29.4 11.5-43.5 32-79.4 44.4-77.4 38.1 6.7 55.8 8.2 75.1-25.2 4-6.9 9.5-16.4 20.3-29.6 17.9-21.8 31.6-21.8 50.4-14.1 42.5 17.4 70.8-6.5 91.5-24l3.7-3.1c14-11.8 26.1-22.1 43.3-22.1 18.3.0 32.8.0 65.4 49.3.0.1.1.2.1.3.2.5.4 1 .7 1.5 13 17.6 32.6 17.7 48.3 17.7z"/><path d="M197.61 503.7c-15.7-2.2-30.3 8.9-32.4 24.6-3.6 25.7-10.5 55.9-18.6 80.8-9.8 30.3-20.5 50.7-30.8 59.1-6 4.8-9.9 11.6-10.8 19.2-.9 7.6 1.2 15.2 6 21.2s11.6 9.9 19.2 10.8c1.2.1 2.3.2 3.5.2 6.4.0 12.6-2.1 17.7-6.2.2-.2.4-.3.6-.5 21.2-17.1 39.2-50.4 53.4-98.8 11-37.4 16-71.6 16.9-78.1 2-15.6-9-30.2-24.7-32.3zm234.9-238.6c-6.6-4-14.3-5.2-21.8-3.4l-.4.1c-55.8 13.8-74.3 65.3-76.5 93.6-.6 7.7 1.9 15.1 6.9 20.9 5 5.8 12 9.4 19.6 9.9h.1c.7.1 1.4.1 2.1.1 14.9.0 27.5-11.5 28.7-26.6.0-.3 3.2-34.7 32.9-42.1 7.5-1.8 13.8-6.4 17.8-13s5.2-14.3 3.4-21.8c-1.6-7.4-6.2-13.7-12.8-17.7zm144.2 34.3c-1.8.4-18 3.3-28.7-18.6-6.9-14.3-24.2-20.2-38.5-13.3-6.9 3.4-12.1 9.2-14.6 16.5s-2 15.1 1.3 22c22.5 46.2 61.9 51.2 77.8 51.2 5.8.0 11.4-.6 16.2-1.8 7.5-1.8 13.8-6.4 17.8-13s5.2-14.3 3.4-21.8c-1.8-7.5-6.4-13.8-13-17.8s-14.3-5.2-21.7-3.4z"/></svg></div></div></div><script>function fetchData(){fetch("https://api.suyanw.cn/api/tiangou?type=json").then(e=>e.json()).then(e=>{const t=e.text;document.getElementById("apiData").innerText=t,adjustContainerHeight(t)}).catch(e=>console.error("Error:",e))}function adjustContainerHeight(e){const t=180,n=1.2,s=t+e.length*n;document.getElementById("tiangou").style.height=`${s}px`}document.getElementById("refreshButton").addEventListener("click",fetchData),fetchData()</script><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/posts/openshift4.4-install-offline-static-2-first-setup/featured_hud65c77d60b44ce1ca1267403fddda9a8_5062_1200x0_resize_q75_box.jpg)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>云原生实验室</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>博客</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/openshift4.4-install-offline-static-2-first-setup/>Openshift 4.4 静态 IP 离线安装系列：初始安装</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Openshift 4.4 静态 IP 离线安装系列：初始安装</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-06-02 18:40:45 +0800 +0800">2020年6月2日</time><span class="px-2 text-primary-500">&#183;</span><span>6665 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>14 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/yangchuansheng/blog/tree/main/content/posts/openshift4.4-install-offline-static-2-first-setup/index.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title=编辑内容><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M490.3 40.4c21.9 21.87 21.9 57.33.0 79.2l-30 30.1-98-97.98 30.1-30.06C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7 339.7 74.34l98 97.96L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2l-88.8 29.6C150.1 385.6 141.5 383.4 135 376.1 128.6 370.5 126.4 361 129.2 352.4l29.6-88.8C161.6 255.3 166.2 247.8 172.4 241.7v0zM192 63.1c17.7.0 32 15.23 32 32 0 18.6-14.3 32-32 32H96c-17.67.0-32 15.2-32 32V416c0 17.7 14.33 32 32 32H352c17.7.0 32-14.3 32-32V319.1c0-16.8 14.3-32 32-32s32 15.2 32 32V416c0 53-43 96-96 96H96c-53.02.0-96-43-96-96V159.1c0-53 42.98-96 96-96h96z"/></svg></span></span></a></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/openshift/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Openshift</span></span></span></div></div><div class=flex><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=米开朗基杨 src=/img/avatar_huc87ff6472ac02dded9d02f85c817eafc_103316_192x192_fill_box_center_3.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">米开朗基杨</div><div class="text-sm text-neutral-700 dark:text-neutral-400">云原生搬砖师 & <a href=https://sealos.run target=_blank>Sealos</a> 开发者布道师 & <a href=https://github.com/labring/FastGPT target=_blank>FastGPT</a> 熟练工</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=/index.xml target=_blank aria-label=Rss rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/CarsonYangk8s target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/tmpm1ykjt96.webp target=_blank aria-label=Wechat rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg width="800" height="800" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.8088 7.05902C11.3508 7.06746 10.9637 7.45766 10.9718 7.90277 10.9802 8.36421 11.3599 8.7252 11.8309 8.7196 12.3031 8.71385 12.6613 8.3491 12.6568 7.87785 12.6529 7.41534 12.2749 7.05051 11.8088 7.05902zm-4.45801.85655C7.36789 7.47215 6.98366 7.07275 6.52729 7.05933 6.06002 7.04561 5.67572 7.40269 5.66207 7.8632 5.64827 8.32985 6.0052 8.70373 6.47584 8.71569 6.94241 8.72757 7.33354 8.36996 7.35079 7.91557zm8.54451.75542C14.0388 8.76798 12.4244 9.33078 11.1137 10.6023c-1.3243 1.2847-1.92882 2.8588-1.76358 4.8103C8.62446 15.3226 7.96351 15.2237 7.2988 15.1678 7.06924 15.1484 6.7968 15.1759 6.60235 15.2856 5.95689 15.6498 5.33812 16.061 4.60471 16.5195 4.73928 15.9108 4.82638 15.3778 4.98058 14.8652 5.09398 14.4884 5.04146 14.2788 4.69434 14.0333c-2.22866-1.5734-3.1681-3.9282-2.46505-6.35259.65044-2.24277 2.24776-3.60293 4.41815-4.31196C9.60982 2.4011 12.939 3.38815 14.7404 5.74012 15.391 6.58969 15.7899 7.54323 15.8953 8.67099z" fill="currentcolor"/><path d="M17.6884 12.3843C17.3253 12.3818 17.0167 12.6791 17.0019 13.046 16.9861 13.4383 17.2912 13.7605 17.6794 13.7615 18.055 13.7627 18.3517 13.4787 18.3655 13.105 18.38 12.7117 18.0749 12.387 17.6884 12.3843zm-4.3139 1.3819C13.7489 13.7666 14.057 13.4737 14.0711 13.1041 14.0861 12.7127 13.7713 12.3845 13.3795 12.3828 12.9915 12.381 12.6664 12.714 12.6799 13.0994 12.6927 13.4678 13.003 13.7658 13.3745 13.7662zm6.6919 6.479C19.4785 19.9835 18.9392 19.5907 18.3652 19.5308 17.7932 19.471 17.1919 19.801 16.5936 19.8622 14.771 20.0486 13.138 19.5407 11.7916 18.2956 9.23081 15.927 9.59671 12.2954 12.5594 10.3543c2.6331-1.72503 6.4948-1.14995 8.3513 1.2437C22.5307 13.6866 22.3403 16.4592 20.3626 18.2139 19.7903 18.7217 19.5843 19.1397 19.9515 19.809 20.0193 19.9326 20.027 20.0891 20.0664 20.2452z" fill="currentcolor"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/yangchuansheng target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://t.me/cloudnativer target=_blank aria-label=Telegram rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#1-安装过程>1. 安装过程</a></li><li><a href=#2-准备服务器资源>2. 准备服务器资源</a></li><li><a href=#3-防火墙配置>3. 防火墙配置</a></li><li><a href=#4-配置-dns>4. 配置 DNS</a></li><li><a href=#5-配置负载均衡>5. 配置负载均衡</a></li><li><a href=#6-安装准备>6. 安装准备</a><ul><li><a href=#生成-ssh-私钥并将其添加到-agent>生成 SSH 私钥并将其添加到 agent</a></li><li><a href=#获取安装程序>获取安装程序</a></li><li><a href=#创建安装配置文件>创建安装配置文件</a></li><li><a href=#创建-kubernetes-部署清单>创建 Kubernetes 部署清单</a></li><li><a href=#创建-ignition-配置文件>创建 Ignition 配置文件</a></li><li><a href=#获取-rhcos-的-bios-文件>获取 RHCOS 的 BIOS 文件</a></li><li><a href=#获取-rhcos-的-iso-文件>获取 RHCOS 的 ISO 文件</a></li></ul></li><li><a href=#7-安装集群>7. 安装集群</a><ul><li><a href=#bootstrap>Bootstrap</a></li><li><a href=#master>Master</a></li><li><a href=#worker>Worker</a></li><li><a href=#登录集群>登录集群</a></li><li><a href=#批准-csr>批准 CSR</a></li><li><a href=#operator-自动初始化>Operator 自动初始化</a></li><li><a href=#完成安装>完成安装</a></li></ul></li><li><a href=#8-参考资料>8. 参考资料</a></li></ul></nav></div></details><details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#1-安装过程>1. 安装过程</a></li><li><a href=#2-准备服务器资源>2. 准备服务器资源</a></li><li><a href=#3-防火墙配置>3. 防火墙配置</a></li><li><a href=#4-配置-dns>4. 配置 DNS</a></li><li><a href=#5-配置负载均衡>5. 配置负载均衡</a></li><li><a href=#6-安装准备>6. 安装准备</a><ul><li><a href=#生成-ssh-私钥并将其添加到-agent>生成 SSH 私钥并将其添加到 agent</a></li><li><a href=#获取安装程序>获取安装程序</a></li><li><a href=#创建安装配置文件>创建安装配置文件</a></li><li><a href=#创建-kubernetes-部署清单>创建 Kubernetes 部署清单</a></li><li><a href=#创建-ignition-配置文件>创建 Ignition 配置文件</a></li><li><a href=#获取-rhcos-的-bios-文件>获取 RHCOS 的 BIOS 文件</a></li><li><a href=#获取-rhcos-的-iso-文件>获取 RHCOS 的 ISO 文件</a></li></ul></li><li><a href=#7-安装集群>7. 安装集群</a><ul><li><a href=#bootstrap>Bootstrap</a></li><li><a href=#master>Master</a></li><li><a href=#worker>Worker</a></li><li><a href=#登录集群>登录集群</a></li><li><a href=#批准-csr>批准 CSR</a></li><li><a href=#operator-自动初始化>Operator 自动初始化</a></li><li><a href=#完成安装>完成安装</a></li></ul></li><li><a href=#8-参考资料>8. 参考资料</a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=t.attr("id"))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){n()})}})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><style>.slideContent{width:80%;@media(max-width:600px){width: 100%;}&>* { user-select: none; } .swiper-slide { a { height: 100%; } img { height: 100%; object-fit: cover; } }}.swiper,swiper-container{margin-left:inherit!important;margin-bottom:-30px}</style><link rel=stylesheet href=https://cdn.staticfile.org/Swiper/9.0.2/swiper-bundle.min.css><script src=https://cdn.staticfile.org/Swiper/9.0.2/swiper-bundle.min.js></script><div class="swiper slideContent" id=slider><div class=swiper-wrapper><div class=swiper-slide><a data-umami-event=gptgod href="https://gptgod.online/#/register?invite_code=46rrqz6qzscsey1jci7sdjw95" target=_blank><img class=nozoom id=support-img src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/2023-09-15-12-36-W4I1A8.png style=border:none;width:100%;max-width:100%;display:inline-block></a></div><div class=swiper-slide><a data-umami-event=FastGPT href="https://ai.fastgpt.in/?inviterId=64215e9914d068bf840141d0" target=_blank><img class=nozoom id=support-img src="https://socialify.git.ci/labring/fastgpt/image?description=1&amp;descriptionEditable=%E5%9F%BA%E4%BA%8E%20LLM%20%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%9F%A5%E8%AF%86%E5%BA%93%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E3%80%81%E6%A8%A1%E5%9E%8B%E8%B0%83%E7%94%A8%E7%AD%89%E8%83%BD%E5%8A%9B%E3%80%82&amp;font=Raleway&amp;forks=1&amp;logo=https%3A%2F%2Fjsdelivr.icloudnative.io%2Fgh%2Flabring%2FFastGPT%40main%2F.github%2Fimgs%2Flogo.svg&amp;name=1&amp;pattern=Brick%20Wall&amp;stargazers=1&amp;theme=Light" style=border:none;width:100%;max-width:100%;display:inline-block></a></div><div class=swiper-slide><a data-umami-event=Laf href=https://github.com/labring/laf target=_blank><img class=nozoom id=support-img src="https://socialify.git.ci/labring/laf/image?description=1&amp;descriptionEditable=Laf%20%E6%98%AF%E4%B8%80%E4%B8%AA%20Serverless%20%E6%A1%86%E6%9E%B6%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8%E7%9A%84%E4%BA%91%E5%87%BD%E6%95%B0%EF%BC%8C%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%AD%89%E8%83%BD%E5%8A%9B%E3%80%82%E8%AE%A9%E5%BC%80%E5%8F%91%E8%80%85%E4%B8%93%E6%B3%A8%E4%BA%8E%E4%B8%9A%E5%8A%A1%E5%BC%80%E5%8F%91%EF%BC%8C%E6%97%A0%E9%9C%80%E6%8A%98%E8%85%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%BF%AB%E9%80%9F%E9%87%8A%E6%94%BE%E5%88%9B%E6%84%8F%E3%80%82&amp;font=Raleway&amp;forks=1&amp;logo=https%3A%2F%2Fjsdelivr.icloudnative.io%2Fgh%2Fyangchuansheng%2Fimghosting-test%40main%2FuPic%2F2023-11-13-11-33-rI41Bu.svg&amp;name=1&amp;pattern=Brick%20Wall&amp;stargazers=1&amp;theme=Light" style=border:none;width:100%;max-width:100%;display:inline-block></a></div><div class=swiper-slide><a data-umami-event href=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200430221955.png target=_blank><img class=nozoom id=support-img src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting5@main/uPic/2023-02-05-16-18-ofcgZS.png style=border:none;width:100%;max-width:100%;display:inline-block></a></div></div><div class=swiper-button-prev></div><div class=swiper-button-next></div></div><script>var mySwiper=new Swiper("#slider",{direction:"horizontal",loop:!0,autoplay:{delay:5e3},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})</script><div class="max-w-prose mb-20"><p><a href=/posts/openshift4.4-install-offline-static-1-requirement/>上篇文章</a>准备了离线安装 OCP 所需要的离线资源，包括安装镜像、所有样例 <code>Image Stream</code> 和 <code>OperatorHub</code> 中的所有 RedHat Operators。本文就开始正式安装 <code>OCP</code>（Openshift Container Platform） 集群，包括 DNS 解析、负载均衡配置、<code>ignition</code> 配置文件生成和集群部署。</p><p><code>OCP</code> 安装期间需要用到多个文件：安装配置文件、Kubernetes 部署清单、Ignition 配置文件（包含了 machine types）。<strong>安装配置文件将被转换为 Kubernetes 部署清单，然后将清单包装到 <code>Ignition</code> 配置文件中。</strong> 安装程序使用这些 <code>Ignition</code> 配置文件来创建 Openshift 集群。运行安装程序时，所有原始安装配置文件都会修改，因此在安装之前应该先备份文件。</p><h2 class="relative group">1. 安装过程<div id=1-安装过程 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-%e5%ae%89%e8%a3%85%e8%bf%87%e7%a8%8b aria-label=锚点>#</a></span></h2><p>在安装 OCP 时，我们需要有一台引导主机（<code>Bootstrap</code>）。这个主机可以访问所有的 OCP 节点。引导主机启动一个临时控制平面，它启动 OCP 集群的其余部分然后被销毁。引导主机使用 Ignition 配置文件进行集群安装引导，该文件描述了如何创建 OCP 集群。<strong>安装程序生成的 Ignition 配置文件包含 24 小时后过期的证书，所以必须在证书过期之前完成集群安装。</strong></p><p>引导集群安装包括如下步骤：</p><ul><li>引导主机启动并开始托管 <code>Master</code> 节点启动所需的资源。</li><li><code>Master</code> 节点从引导主机远程获取资源并完成引导。</li><li><code>Master</code> 节点通过引导主机构建 <code>Etcd</code> 集群。</li><li>引导主机使用新的 <code>Etcd</code> 集群启动临时 <code>Kubernetes</code> 控制平面。</li><li>临时控制平面在 Master 节点启动生成控制平面。</li><li>临时控制平面关闭并将控制权传递给生产控制平面。</li><li>引导主机将 OCP 组件注入生成控制平面。</li><li>安装程序关闭引导主机。</li></ul><p>引导安装过程完成以后，OCP 集群部署完毕。然后集群开始下载并配置日常操作所需的其余组件，包括创建计算节点、通过 <code>Operator</code> 安装其他服务等。</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200602195135.png alt=创建引导主机、控制平面和计算节点></figure></p><h2 class="relative group">2. 准备服务器资源<div id=2-准备服务器资源 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-%e5%87%86%e5%a4%87%e6%9c%8d%e5%8a%a1%e5%99%a8%e8%b5%84%e6%ba%90 aria-label=锚点>#</a></span></h2><p>服务器规划如下：</p><ul><li>三个控制平面节点，安装 <code>Etcd</code>、控制平面组件和 <code>Infras</code> 基础组件。</li><li>两个计算节点，运行实际负载。</li><li>一个引导主机，执行安装任务，集群部署完成后可删除。</li><li>一个基础节点，用于准备上节提到的离线资源，同时用来部署 DNS 和负载均衡。</li><li>一个镜像节点，用来部署私有镜像仓库 <code>Quay</code>。</li></ul><table><thead><tr><th align=center>主机类型</th><th align=center>操作系统</th><th align=center>Hostname</th><th align=center>vCPU</th><th>内存</th><th align=center>存储</th><th align=center>IP</th><th align=center>FQDN</th></tr></thead><tbody><tr><td align=center>镜像节点</td><td align=center>RHEL 7.6</td><td align=center>registry</td><td align=center>4</td><td>8GB</td><td align=center>150GB</td><td align=center>192.168.57.70</td><td align=center>registry.openshift4.example.com</td></tr><tr><td align=center>基础节点</td><td align=center>RHEL 7.6</td><td align=center>bastion</td><td align=center>4</td><td>16GB</td><td align=center>120GB</td><td align=center>192.168.57.60</td><td align=center>bastion.openshift4.example.com</td></tr><tr><td align=center>引导主机</td><td align=center>RHCOS</td><td align=center>bootstrap</td><td align=center>4</td><td>16GB</td><td align=center>120GB</td><td align=center>192.168.57.61</td><td align=center>bootstrap.openshift4.example.com</td></tr><tr><td align=center>控制平面</td><td align=center>RHCOS</td><td align=center>master1</td><td align=center>4</td><td>16GB</td><td align=center>120GB</td><td align=center>192.168.57.62</td><td align=center>master1.openshift4.example.com</td></tr><tr><td align=center>控制平面</td><td align=center>RHCOS</td><td align=center>master2</td><td align=center>4</td><td>16GB</td><td align=center>120GB</td><td align=center>192.168.57.63</td><td align=center>master2.openshift4.example.com</td></tr><tr><td align=center>控制平面</td><td align=center>RHCOS</td><td align=center>master3</td><td align=center>4</td><td>16GB</td><td align=center>120GB</td><td align=center>192.168.57.64</td><td align=center>master3.openshift4.example.com</td></tr><tr><td align=center>计算节点</td><td align=center>RHCOS 或 RHEL 7.6</td><td align=center>worker1</td><td align=center>2</td><td>8GB</td><td align=center>120GB</td><td align=center>192.168.57.65</td><td align=center>worker1.openshift4.example.com</td></tr><tr><td align=center>计算节点</td><td align=center>RHCOS 或 RHEL 7.6</td><td align=center>worker2</td><td align=center>2</td><td>8GB</td><td align=center>120GB</td><td align=center>192.168.57.66</td><td align=center>worke2.openshift4.example.com</td></tr></tbody></table><h2 class="relative group">3. 防火墙配置<div id=3-防火墙配置 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-%e9%98%b2%e7%81%ab%e5%a2%99%e9%85%8d%e7%bd%ae aria-label=锚点>#</a></span></h2><p>接下来看一下每个节点的端口号分配。</p><p>所有节点（计算节点和控制平面）之间需要开放的端口：</p><table><thead><tr><th align=center>协议</th><th align=center>端口</th><th align=center>作用</th></tr></thead><tbody><tr><td align=center>ICMP</td><td align=center>N/A</td><td align=center>测试网络连通性</td></tr><tr><td align=center>TCP</td><td align=center><code>9000-9999</code></td><td align=center>节点的服务端口，包括 node exporter 使用的 <code>9100-9101</code> 端口和 Cluster Version Operator 使用的 <code>9099</code> 端口</td></tr><tr><td align=center></td><td align=center><code>10250</code>-<code>10259</code></td><td align=center>Kubernetes 预留的默认端口</td></tr><tr><td align=center></td><td align=center><code>10256</code></td><td align=center>openshift-sdn</td></tr><tr><td align=center>UDP</td><td align=center><code>4789</code></td><td align=center>VXLAN 协议或 GENEVE 协议的通信端口</td></tr><tr><td align=center></td><td align=center><code>6081</code></td><td align=center>VXLAN 协议或 GENEVE 协议的通信端口</td></tr><tr><td align=center></td><td align=center><code>9000</code>-<code>9999</code></td><td align=center>节点的服务端口，包括 node exporter 使用的 <code>9100-9101</code> 端口</td></tr><tr><td align=center></td><td align=center><code>30000</code>-<code>32767</code></td><td align=center>Kubernetes NodePort</td></tr></tbody></table><p>控制平面需要向其他节点开放的端口：</p><table><thead><tr><th align=center>协议</th><th align=center>端口</th><th align=center>作用</th></tr></thead><tbody><tr><td align=center>TCP</td><td align=center><code>2379</code>-<code>2380</code></td><td align=center>Etcd 服务端口</td></tr><tr><td align=center></td><td align=center><code>6443</code></td><td align=center>Kubernetes API</td></tr></tbody></table><p>除此之外，还要配置两个四层负载均衡器，一个用来暴露集群 API，一个用来暴露 Ingress：</p><table><thead><tr><th align=center>端口</th><th align=center>作用</th><th align=center>内部</th><th align=center>外部</th><th align=center>描述</th></tr></thead><tbody><tr><td align=center><code>6443</code></td><td align=center>引导主机和控制平面使用。在引导主机初始化集群控制平面后，需从负载均衡器中手动删除引导主机</td><td align=center>x</td><td align=center>x</td><td align=center>Kubernetes API server</td></tr><tr><td align=center><code>22623</code></td><td align=center>引导主机和控制平面使用。在引导主机初始化集群控制平面后，需从负载均衡器中手动删除引导主机</td><td align=center></td><td align=center>x</td><td align=center>Machine Config server</td></tr><tr><td align=center><code>443</code></td><td align=center>Ingress Controller 或 Router 使用</td><td align=center>x</td><td align=center>x</td><td align=center>HTTPS 流量</td></tr><tr><td align=center><code>80</code></td><td align=center>Ingress Controller 或 Router 使用</td><td align=center>x</td><td align=center>x</td><td align=center>HTTP 流量</td></tr></tbody></table><h2 class="relative group">4. 配置 DNS<div id=4-配置-dns class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-%e9%85%8d%e7%bd%ae-dns aria-label=锚点>#</a></span></h2><p>按照官方文档，使用 UPI 基础架构的 OCP 集群需要以下的 DNS 记录。在每条记录中，<code>&lt;cluster_name></code> 是集群名称，<code>&lt;base_domain></code> 是在 <code>install-config.yaml</code> 文件中指定的集群基本域，如下表所示：</p><table><thead><tr><th align=center>组件</th><th align=center>DNS记录</th><th align=center>描述</th></tr></thead><tbody><tr><td align=center>Kubernetes API</td><td align=center><code>api.&lt;cluster_name>.&lt;base_domain>.</code></td><td align=center>此 DNS 记录必须指向控制平面节点的负载均衡器。此记录必须可由集群外部的客户端和集群中的所有节点解析。</td></tr><tr><td align=center></td><td align=center><code>api-int.&lt;cluster_name>.&lt;base_domain>.</code></td><td align=center>此 DNS 记录必须指向控制平面节点的负载均衡器。此记录必须可由集群外部的客户端和集群中的所有节点解析。</td></tr><tr><td align=center>Routes</td><td align=center><code>*.apps.&lt;cluster_name>.&lt;base_domain>.</code></td><td align=center>DNS 通配符记录，指向负载均衡器。这个负载均衡器的后端是 Ingress router 所在的节点，默认是计算节点。此记录必须可由集群外部的客户端和集群中的所有节点解析。</td></tr><tr><td align=center>etcd</td><td align=center><code>etcd-&lt;index>.&lt;cluster_name>.&lt;base_domain>.</code></td><td align=center>OCP 要求每个 etcd 实例的 DNS 记录指向运行实例的控制平面节点。etcd 实例由 <index>值区分，它们以 <code>0</code> 开头，以 <code>n-1</code> 结束，其中 <code>n</code> 是集群中控制平面节点的数量。集群中的所有节点必须都可以解析此记录。</td></tr><tr><td align=center></td><td align=center><code>_etcd-server-ssl._tcp.&lt;cluster_name>.&lt;base_domain>.</code></td><td align=center>因为 etcd 使用端口 <code>2380</code> 对外服务，因此需要建立对应每台 etcd 节点的 SRV DNS 记录，优先级 0，权重 10 和端口 2380</td></tr></tbody></table><p>DNS 服务的部署方法由很多种，我当然推荐使用 <code>CoreDNS</code>，毕竟云原生标配。由于这里需要添加 SRV 记录，所以需要 CoreDNS 结合 <code>etcd</code> 插件使用。<strong>以下所有操作在基础节点上执行。</strong></p><p>首先通过 yum 安装并启动 etcd：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ yum install -y etcd
</span></span><span class=line><span class=cl>$ systemctl <span class=nb>enable</span> etcd --now
</span></span></code></pre></div><p>然后下载 CoreDNS 二进制文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wget https://github.com/coredns/coredns/releases/download/v1.6.9/coredns_1.6.9_linux_amd64.tgz
</span></span><span class=line><span class=cl>$ tar zxvf coredns_1.6.9_linux_amd64.tgz
</span></span><span class=line><span class=cl>$ mv coredns /usr/local/bin
</span></span></code></pre></div><p>创建 <code>Systemd Unit</code> 文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat &gt; /etc/systemd/system/coredns.service <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>[Unit]
</span></span></span><span class=line><span class=cl><span class=s>Description=CoreDNS DNS server
</span></span></span><span class=line><span class=cl><span class=s>Documentation=https://coredns.io
</span></span></span><span class=line><span class=cl><span class=s>After=network.target
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Service]
</span></span></span><span class=line><span class=cl><span class=s>PermissionsStartOnly=true
</span></span></span><span class=line><span class=cl><span class=s>LimitNOFILE=1048576
</span></span></span><span class=line><span class=cl><span class=s>LimitNPROC=512
</span></span></span><span class=line><span class=cl><span class=s>CapabilityBoundingSet=CAP_NET_BIND_SERVICE
</span></span></span><span class=line><span class=cl><span class=s>AmbientCapabilities=CAP_NET_BIND_SERVICE
</span></span></span><span class=line><span class=cl><span class=s>NoNewPrivileges=true
</span></span></span><span class=line><span class=cl><span class=s>User=coredns
</span></span></span><span class=line><span class=cl><span class=s>WorkingDirectory=~
</span></span></span><span class=line><span class=cl><span class=s>ExecStart=/usr/local/bin/coredns -conf=/etc/coredns/Corefile
</span></span></span><span class=line><span class=cl><span class=s>ExecReload=/bin/kill -SIGUSR1 $MAINPID
</span></span></span><span class=line><span class=cl><span class=s>Restart=on-failure
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Install]
</span></span></span><span class=line><span class=cl><span class=s>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>新建 <code>coredns</code> 用户：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ useradd coredns -s /sbin/nologin
</span></span></code></pre></div><p>新建 CoreDNS 配置文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat &gt; /etc/coredns/Corefile <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>.:53 {  # 监听 TCP 和 UDP 的 53 端口
</span></span></span><span class=line><span class=cl><span class=s>    template IN A apps.openshift4.example.com {
</span></span></span><span class=line><span class=cl><span class=s>    match .*apps\.openshift4\.example\.com # 匹配请求 DNS 名称的正则表达式
</span></span></span><span class=line><span class=cl><span class=s>    answer &#34;{{ .Name }} 60 IN A 192.168.57.60&#34; # DNS 应答
</span></span></span><span class=line><span class=cl><span class=s>    fallthrough
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    etcd {   # 配置启用 etcd 插件,后面可以指定域名,例如 etcd test.com {
</span></span></span><span class=line><span class=cl><span class=s>        path /skydns # etcd 里面的路径 默认为 /skydns，以后所有的 dns 记录都存储在该路径下
</span></span></span><span class=line><span class=cl><span class=s>        endpoint http://localhost:2379 # etcd 访问地址，多个空格分开
</span></span></span><span class=line><span class=cl><span class=s>        fallthrough # 如果区域匹配但不能生成记录，则将请求传递给下一个插件
</span></span></span><span class=line><span class=cl><span class=s>        # tls CERT KEY CACERT # 可选参数，etcd 认证证书设置
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>    prometheus  # 监控插件
</span></span></span><span class=line><span class=cl><span class=s>    cache 160
</span></span></span><span class=line><span class=cl><span class=s>    loadbalance   # 负载均衡，开启 DNS 记录轮询策略
</span></span></span><span class=line><span class=cl><span class=s>    forward . 192.168.57.1
</span></span></span><span class=line><span class=cl><span class=s>    log # 打印日志
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>其中 <code>template</code> 插件用来实现泛域名解析。</p><p>启动 CoreDNS 并设置开机自启：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ systemctl <span class=nb>enable</span> coredns --now
</span></span></code></pre></div><p>验证泛域名解析：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ dig +short apps.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.60
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dig +short x.apps.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.60
</span></span></code></pre></div><p>添加其余 DNS 记录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>alias</span> <span class=nv>etcdctlv3</span><span class=o>=</span><span class=s1>&#39;ETCDCTL_API=3 etcdctl&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/api <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.60&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/api-int <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.60&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/etcd-0 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.62&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/etcd-1 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.63&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/etcd-2 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.64&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/_tcp/_etcd-server-ssl/x1 <span class=s1>&#39;{&#34;host&#34;:&#34;etcd-0.openshift4.example.com&#34;,&#34;ttl&#34;:60,&#34;priority&#34;:0,&#34;weight&#34;:10,&#34;port&#34;:2380}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/_tcp/_etcd-server-ssl/x2 <span class=s1>&#39;{&#34;host&#34;:&#34;etcd-1.openshift4.example.com&#34;,&#34;ttl&#34;:60,&#34;priority&#34;:0,&#34;weight&#34;:10,&#34;port&#34;:2380}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/_tcp/_etcd-server-ssl/x3 <span class=s1>&#39;{&#34;host&#34;:&#34;etcd-2.openshift4.example.com&#34;,&#34;ttl&#34;:60,&#34;priority&#34;:0,&#34;weight&#34;:10,&#34;port&#34;:2380}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 除此之外再添加各节点主机名记录</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/bootstrap <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.61&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/master1 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.62&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/master2 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.63&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/master3 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.64&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/worker1 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.65&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/worker2 <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.66&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span><span class=line><span class=cl>$ etcdctlv3 put /skydns/com/example/openshift4/registry <span class=s1>&#39;{&#34;host&#34;:&#34;192.168.57.70&#34;,&#34;ttl&#34;:60}&#39;</span>
</span></span></code></pre></div><p>验证 DNS 解析：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ yum install -y bind-utils
</span></span><span class=line><span class=cl>$ dig +short api.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.60
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dig +short api-int.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.60
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dig +short etcd-0.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.62
</span></span><span class=line><span class=cl>$ dig +short etcd-1.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.63
</span></span><span class=line><span class=cl>$ dig +short etcd-2.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dig +short -t SRV _etcd-server-ssl._tcp.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl><span class=m>10</span> <span class=m>33</span> <span class=m>2380</span> etcd-0.openshift4.example.com.
</span></span><span class=line><span class=cl><span class=m>10</span> <span class=m>33</span> <span class=m>2380</span> etcd-1.openshift4.example.com.
</span></span><span class=line><span class=cl><span class=m>10</span> <span class=m>33</span> <span class=m>2380</span> etcd-2.openshift4.example.com.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dig +short bootstrap.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.61
</span></span><span class=line><span class=cl>$ dig +short master1.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.62
</span></span><span class=line><span class=cl>$ dig +short master2.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.63
</span></span><span class=line><span class=cl>$ dig +short master3.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.64
</span></span><span class=line><span class=cl>$ dig +short worker1.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.65
</span></span><span class=line><span class=cl>$ dig +short worker2.openshift4.example.com @127.0.0.1
</span></span><span class=line><span class=cl>192.168.57.66
</span></span></code></pre></div><h2 class="relative group">5. 配置负载均衡<div id=5-配置负载均衡 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-%e9%85%8d%e7%bd%ae%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1 aria-label=锚点>#</a></span></h2><p>负载均衡我选择使用 <code>Envoy</code>，先准备配置文件：</p><div class=tabs><button class=tablinks onclick='openTab(event,"Bootstrap")'>Bootstrap</button>
<button class=tablinks onclick='openTab(event,"LDS")'>LDS</button>
<button class=tablinks onclick='openTab(event,"CDS")'>CDS</button></div><div id=Bootstrap class=tabcontent><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># /etc/envoy/envoy.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>node</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>node0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>cluster0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dynamic_resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lds_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/envoy/lds.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cds_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/envoy/cds.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>admin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>access_log_path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/dev/stdout&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>15001</span><span class=w>
</span></span></span></code></pre></div></div><div id=LDS class=tabcontent><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># /etc/envoy/lds.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version_info</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.listener.v3.Listener</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>listener_openshift-api-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>6443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filter_chains</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>filters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.tcp_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>stat_prefix</span><span class=p>:</span><span class=w> </span><span class=l>openshift-api-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>openshift-api-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>access_log</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.access_loggers.file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.access_loggers.file.v3.FileAccessLog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/dev/stdout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.listener.v3.Listener</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>listener_machine-config-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;::&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ipv4_compat</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>22623</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filter_chains</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>filters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.tcp_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>stat_prefix</span><span class=p>:</span><span class=w> </span><span class=l>machine-config-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>machine-config-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>access_log</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.access_loggers.file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.access_loggers.file.v3.FileAccessLog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/dev/stdout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.listener.v3.Listener</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>listener_ingress-http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;::&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ipv4_compat</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filter_chains</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>filters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.tcp_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>stat_prefix</span><span class=p>:</span><span class=w> </span><span class=l>ingress-http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>ingress-http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>access_log</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.access_loggers.file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.access_loggers.file.v3.FileAccessLog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/dev/stdout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.listener.v3.Listener</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>listener_ingress-https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;::&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ipv4_compat</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filter_chains</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>filters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.tcp_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>stat_prefix</span><span class=p>:</span><span class=w> </span><span class=l>ingress-https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>ingress-https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>access_log</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>envoy.access_loggers.file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>typed_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.extensions.access_loggers.file.v3.FileAccessLog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/dev/stdout</span><span class=w>
</span></span></span></code></pre></div></div><div id=CDS class=tabcontent><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># /etc/envoy/cds.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version_info</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.cluster.v3.Cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>openshift-api-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connect_timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>strict_dns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dns_lookup_family</span><span class=p>:</span><span class=w> </span><span class=l>V4_ONLY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lb_policy</span><span class=p>:</span><span class=w> </span><span class=l>ROUND_ROBIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>load_assignment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cluster_name</span><span class=p>:</span><span class=w> </span><span class=l>openshift-api-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>lb_endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.61</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>6443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.62</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>6443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.63</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>6443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>6443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.cluster.v3.Cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>machine-config-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connect_timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>strict_dns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dns_lookup_family</span><span class=p>:</span><span class=w> </span><span class=l>V4_ONLY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lb_policy</span><span class=p>:</span><span class=w> </span><span class=l>ROUND_ROBIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>load_assignment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cluster_name</span><span class=p>:</span><span class=w> </span><span class=l>machine-config-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>lb_endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.61</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>22623</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.62</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>22623</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.63</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>22623</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>22623</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.cluster.v3.Cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connect_timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>strict_dns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dns_lookup_family</span><span class=p>:</span><span class=w> </span><span class=l>V4_ONLY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lb_policy</span><span class=p>:</span><span class=w> </span><span class=l>ROUND_ROBIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>load_assignment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cluster_name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>lb_endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.65</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.66</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>&#34;@type&#34;: </span><span class=l>type.googleapis.com/envoy.config.cluster.v3.Cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connect_timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>strict_dns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dns_lookup_family</span><span class=p>:</span><span class=w> </span><span class=l>V4_ONLY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lb_policy</span><span class=p>:</span><span class=w> </span><span class=l>ROUND_ROBIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>load_assignment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cluster_name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-https</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>lb_endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.65</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>socket_address</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=m>192.168.57.66</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>port_value</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span></code></pre></div></div><script>function openTab(e,t){var n,s,o=document.getElementsByClassName("tabcontent");for(n=0;n<o.length;n++)o[n].style.display="none";s=document.getElementsByClassName("tablinks");for(n=0;n<s.length;n++)s[n].classList.remove("active");document.getElementById(t).style.display="block",e.currentTarget.classList.add("active")}document.addEventListener("DOMContentLoaded",function(){document.getElementsByClassName("tablinks").length>0&&document.getElementsByClassName("tablinks")[0].click()})</script><p>配置看不懂的去看我的电子书：<a href=https://icloudnative.io/envoy-handbook/ target=_blank>Envoy 中文指南</a></p><p>启动 <code>Envoy</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ podman run -d --restart<span class=o>=</span>always --name envoy --net host -v /etc/envoy:/etc/envoy envoyproxy/envoy
</span></span></code></pre></div><h2 class="relative group">6. 安装准备<div id=6-安装准备 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#6-%e5%ae%89%e8%a3%85%e5%87%86%e5%a4%87 aria-label=锚点>#</a></span></h2><h3 class="relative group">生成 SSH 私钥并将其添加到 agent<div id=生成-ssh-私钥并将其添加到-agent class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e7%94%9f%e6%88%90-ssh-%e7%a7%81%e9%92%a5%e5%b9%b6%e5%b0%86%e5%85%b6%e6%b7%bb%e5%8a%a0%e5%88%b0-agent aria-label=锚点>#</a></span></h3><p>在安装过程中，我们会在基础节点上执行 OCP 安装调试和灾难恢复，因此必须在基础节点上配置 SSH key，<code>ssh-agent</code> 将会用它来执行安装程序。</p><p>基础节点上的 <code>core</code> 用户可以使用该私钥登录到 Master 节点。部署集群时，该私钥会被添加到 core 用户的 <code>~/.ssh/authorized_keys</code> 列表中。</p><p>密钥创建步骤如下：</p><p>① 创建无密码验证的 SSH key：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ssh-keygen -t rsa -b <span class=m>4096</span> -N <span class=s1>&#39;&#39;</span> -f ~/.ssh/new_rsa
</span></span></code></pre></div><p>② 启动 <code>ssh-agent</code> 进程作为后台任务：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>ssh-agent -s<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>③ 将 SSH 私钥添加到 <code>ssh-agent</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ssh-add ~/.ssh/new_rsa
</span></span></code></pre></div><p>后续集群安装过程中，有一步会提示输入 SSH public key，届时使用前面创建的公钥 <code>new_rsa.pub</code> 就可以了。</p><h3 class="relative group">获取安装程序<div id=获取安装程序 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e8%8e%b7%e5%8f%96%e5%ae%89%e8%a3%85%e7%a8%8b%e5%ba%8f aria-label=锚点>#</a></span></h3><p>如果是在线安装，还需要在基础节点上下载安装程序。但这里是离线安装，安装程序在上篇文章中已经被提取出来了，所以不需要再下载。</p><h3 class="relative group">创建安装配置文件<div id=创建安装配置文件 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%88%9b%e5%bb%ba%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label=锚点>#</a></span></h3><p>首先创建一个安装目录，用来存储安装所需要的文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir /ocpinstall
</span></span></code></pre></div><p>自定义 <code>install-config.yaml</code> 并将其保存在 <code>/ocpinstall</code> 目录中。配置文件必须命名为 <code>install-config.yaml</code>。配置文件内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>baseDomain</span><span class=p>:</span><span class=w> </span><span class=l>example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>compute</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>hyperthreading</span><span class=p>:</span><span class=w> </span><span class=l>Enabled</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>worker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>controlPlane</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hyperthreading</span><span class=p>:</span><span class=w> </span><span class=l>Enabled</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>openshift4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>networking</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>clusterNetwork</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>cidr</span><span class=p>:</span><span class=w> </span><span class=m>10.128.0.0</span><span class=l>/14</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hostPrefix</span><span class=p>:</span><span class=w> </span><span class=m>23</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>networkType</span><span class=p>:</span><span class=w> </span><span class=l>OpenShiftSDN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceNetwork</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=m>172.30.0.0</span><span class=l>/16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>platform</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>none</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>fips</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>pullSecret</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;{&#34;auths&#34;: ...}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>sshKey</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;ssh-rsa ...&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>additionalTrustBundle</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>  -----BEGIN CERTIFICATE-----
</span></span></span><span class=line><span class=cl><span class=sd>  省略，注意这里要前面空两格
</span></span></span><span class=line><span class=cl><span class=sd>  -----END CERTIFICATE-----</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>imageContentSources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>mirrors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>registry.openshift4.example.com/ocp4/openshift4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=l>quay.io/openshift-release-dev/ocp-release</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>mirrors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>registry.openshift4.example.com/ocp4/openshift4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=l>quay.io/openshift-release-dev/ocp-v4.0-art-dev</span><span class=w>
</span></span></span></code></pre></div><ul><li><strong>baseDomain</strong> : 所有 Openshift 内部的 DNS 记录必须是此基础的子域，并包含集群名称。</li><li><strong>compute</strong> : 计算节点配置。这是一个数组，每一个元素必须以连字符 <code>-</code> 开头。</li><li><strong>hyperthreading</strong> : Enabled 表示启用同步多线程或超线程。默认启用同步多线程，可以提高机器内核的性能。如果要禁用，则控制平面和计算节点都要禁用。</li><li><strong>compute.replicas</strong> : 计算节点数量。因为我们要手动创建计算节点，所以这里要设置为 0。</li><li><strong>controlPlane.replicas</strong> : 控制平面节点数量。控制平面节点数量必须和 etcd 节点数量一致，为了实现高可用，本文设置为 3。</li><li><strong>metadata.name</strong> : 集群名称。即前面 DNS 记录中的 <code>&lt;cluster_name></code>。</li><li><strong>cidr</strong> : 定义了分配 Pod IP 的 IP 地址段，不能和物理网络重叠。</li><li><strong>hostPrefix</strong> : 分配给每个节点的子网前缀长度。例如，如果将 <code>hostPrefix</code> 设置为 <code>23</code>，则为每一个节点分配一个给定 cidr 的 <code>/23</code> 子网，允许 $510 (2^{32 - 23} - 2)$ 个 Pod IP 地址。</li><li><strong>serviceNetwork</strong> : Service IP 的地址池，只能设置一个。</li><li><strong>pullSecret</strong> : 上篇文章使用的 pull secret，可通过命令 <code>cat /root/pull-secret.json|jq -c</code> 来压缩成一行。</li><li><strong>sshKey</strong> : 上面创建的公钥，可通过命令 <code>cat ~/.ssh/new_rsa.pub</code> 查看。</li><li><strong>additionalTrustBundle</strong> : 私有镜像仓库 Quay 的信任证书，可在镜像节点上通过命令 <code>cat /data/quay/config/ssl.cert</code> 查看。</li><li><strong>imageContentSources</strong> : 来自前面 <code>oc adm release mirror</code> 的输出结果。</li></ul><p>备份安装配置文件，便于以后重复使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> /ocpinstall
</span></span><span class=line><span class=cl>$ cp install-config.yaml  install-config.yaml.20200604
</span></span></code></pre></div><h3 class="relative group">创建 Kubernetes 部署清单<div id=创建-kubernetes-部署清单 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%88%9b%e5%bb%ba-kubernetes-%e9%83%a8%e7%bd%b2%e6%b8%85%e5%8d%95 aria-label=锚点>#</a></span></h3><blockquote><p>创建 Kubernetes 部署清单后 <code>install-config.yaml</code> 将被删除，请务必先备份此文件！</p></blockquote><p>创建 Kubernetes 部署清单文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openshift-install create manifests --dir<span class=o>=</span>/ocpinstall
</span></span></code></pre></div><p>修改 <code>manifests/cluster-scheduler-02-config.yml</code> 文件，将 <code>mastersSchedulable</code> 的值设为 <code>flase</code>，以防止 Pod 调度到控制节点。</p><h3 class="relative group">创建 Ignition 配置文件<div id=创建-ignition-配置文件 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%88%9b%e5%bb%ba-ignition-%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label=锚点>#</a></span></h3><blockquote><p>创建 Ignition 配置文件后 <code>install-config.yaml</code> 将被删除，请务必先备份此文件！</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cp install-config.yaml.20200604 install-config.yaml
</span></span><span class=line><span class=cl>$ openshift-install create ignition-configs --dir<span class=o>=</span>/ocpinstall
</span></span></code></pre></div><p>生成的文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>├── auth
</span></span><span class=line><span class=cl>│   ├── kubeadmin-password
</span></span><span class=line><span class=cl>│   └── kubeconfig
</span></span><span class=line><span class=cl>├── bootstrap.ign
</span></span><span class=line><span class=cl>├── master.ign
</span></span><span class=line><span class=cl>├── metadata.json
</span></span><span class=line><span class=cl>└── worker.ign
</span></span></code></pre></div><p>准备一个 HTTP 服务，这里选择使用 Nginx：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ yum install -y nginx
</span></span></code></pre></div><p>修改 Nginx 的配置文件 <code>/etc/nginx/nginx/.conf</code>，将端口改为 <code>8080</code>（因为负载均衡器已经占用了 80 端口）。然后启动 Nginx 服务：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ systemctl <span class=nb>enable</span> nginx --now
</span></span></code></pre></div><p>将 <code>Ignition</code> 配置文件拷贝到 HTTP 服务的 ignition 目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir /usr/share/nginx/html/ignition
</span></span><span class=line><span class=cl>$ cp -r *.ign /usr/share/nginx/html/ignition/
</span></span></code></pre></div><h3 class="relative group">获取 RHCOS 的 BIOS 文件<div id=获取-rhcos-的-bios-文件 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e8%8e%b7%e5%8f%96-rhcos-%e7%9a%84-bios-%e6%96%87%e4%bb%b6 aria-label=锚点>#</a></span></h3><p>下载用于裸机安装的 BIOS 文件，并上传到 Nginx 的目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir /usr/share/nginx/html/install
</span></span><span class=line><span class=cl>$ wget https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/4.4/latest/rhcos-4.4.3-x86_64-metal.x86_64.raw.gz -O /usr/share/nginx/html/install/rhcos-4.4.3-x86_64-metal.x86_64.raw.gz
</span></span></code></pre></div><h3 class="relative group">获取 RHCOS 的 ISO 文件<div id=获取-rhcos-的-iso-文件 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e8%8e%b7%e5%8f%96-rhcos-%e7%9a%84-iso-%e6%96%87%e4%bb%b6 aria-label=锚点>#</a></span></h3><p>本地下载 RHCOS 的 <code>ISO</code> 文件：<a href=https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/4.4/latest/rhcos-4.4.3-x86_64-installer.x86_64.iso target=_blank>https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/4.4/latest/rhcos-4.4.3-x86_64-installer.x86_64.iso</a>，然后上传到 <code>vSphere</code>。步骤如下：</p><p>① 首先登陆 vSphere，然后点击『存储』。<br><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605130737.png alt></figure></p><p>② 选择一个『数据存储』，然后在右边的窗口中选择『上载文件』。</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605131505.png alt></figure></p><p>③ 选择刚刚下载的 ISO 文件，上传到 ESXI 主机。</p><h2 class="relative group">7. 安装集群<div id=7-安装集群 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#7-%e5%ae%89%e8%a3%85%e9%9b%86%e7%be%a4 aria-label=锚点>#</a></span></h2><h3 class="relative group">Bootstrap<div id=bootstrap class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bootstrap aria-label=锚点>#</a></span></h3><p>最后开始正式安装集群，先创建 bootstrap 节点虚拟机，操作系统选择『Red Hat Enterprise Linux 7 (64-Bit)』，并挂载之前上传的 ISO，按照之前的表格设置 CPU 、内存和硬盘，打开电源，然后按照下面的步骤操作：</p><p>① 在 RHCOS Installer 安装界面按 <code>Tab</code> 键进入引导参数配置选项。</p><p>② 在默认选项 <code>coreos.inst = yes</code> 之后添加（由于无法拷贝粘贴，请输入<strong>仔细核对</strong>后再回车进行）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ip</span><span class=o>=</span>192.168.57.61::192.168.57.1:255.255.255.0:bootstrap.openshift4.example.com:ens192:none <span class=nv>nameserver</span><span class=o>=</span>192.168.57.60 coreos.inst.install_dev<span class=o>=</span>sda coreos.inst.image_url<span class=o>=</span>http://192.168.57.60:8080/install/rhcos-4.4.3-x86_64-metal.x86_64.raw.gz coreos.inst.ignition_url<span class=o>=</span>http://192.168.57.60:8080/ignition/bootstrap.ign 
</span></span></code></pre></div><p>其中 <code>ip=...</code> 的含义为 <code>ip=$IPADDRESS::$DEFAULTGW:$NETMASK:$HOSTNAMEFQDN:$IFACE:none</code>。</p><p>如图所示：</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605134815.png alt></figure></p><p>③ 如果安装有问题会进入 <code>emergency shell</code>，检查网络、域名解析是否正常，如果正常一般是以上参数输入有误，reboot 退出 shell 回到第一步重新开始。</p><p>安装成功后从基础节点通过命令 <code>ssh -i ~/.ssh/new_rsa core@192.168.57.61</code> 登录 bootstrap 节点，然后验证：</p><ul><li>网络配置是否符合自己的设定：<ul><li><code>hostname</code></li><li><code>ip route</code></li><li><code>cat /etc/resolv.conf</code></li></ul></li><li>验证是否成功启动 bootstrap 相应服务：<ul><li><code>podman ps</code> 查看服务是否以容器方式运行</li><li>使用 <code>ss -tulnp</code> 查看 6443 和 22623 端口是否启用。</li></ul></li></ul><p>这里简单介绍一下 bootstrap 节点的启动流程，它会先通过 <code>podman</code> 跑一些容器，然后在容器里面启动临时控制平面，这个临时控制平面是通过 <code>CRIO</code> 跑在容器里的，有点绕。。直接看命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ podman ps -a --no-trunc --sort created --format <span class=s2>&#34;{{.Command}}&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>start --tear-down-early<span class=o>=</span><span class=nb>false</span> --asset-dir<span class=o>=</span>/assets --required-pods<span class=o>=</span>openshift-kube-apiserver/kube-apiserver,openshift-kube-scheduler/openshift-kube-scheduler,openshift-kube-controller-manager/kube-controller-manager,openshift-cluster-version/cluster-version-operator
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span><span class=line><span class=cl>render --dest-dir<span class=o>=</span>/assets/cco-bootstrap --cloud-credential-operator-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:244ab9d0fcf7315eb5c399bd3fa7c2e662cf23f87f625757b13f415d484621c3
</span></span><span class=line><span class=cl>bootstrap --etcd-ca<span class=o>=</span>/assets/tls/etcd-ca-bundle.crt --etcd-metric-ca<span class=o>=</span>/assets/tls/etcd-metric-ca-bundle.crt --root-ca<span class=o>=</span>/assets/tls/root-ca.crt --kube-ca<span class=o>=</span>/assets/tls/kube-apiserver-complete-client-ca-bundle.crt --config-file<span class=o>=</span>/assets/manifests/cluster-config.yaml --dest-dir<span class=o>=</span>/assets/mco-bootstrap --pull-secret<span class=o>=</span>/assets/manifests/openshift-config-secret-pull-secret.yaml --etcd-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:aba3c59eb6d088d61b268f83b034230b3396ce67da4f6f6d49201e55efebc6b2 --kube-client-agent-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:8eb481214103d8e0b5fe982ffd682f838b969c8ff7d4f3ed4f83d4a444fb841b --machine-config-operator-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:31dfdca3584982ed5a82d3017322b7d65a491ab25080c427f3f07d9ce93c52e2 --machine-config-oscontent-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:b397960b7cc14c2e2603111b7385c6e8e4b0f683f9873cd9252a789175e5c4e1 --infra-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:d7862a735f492a18cb127742b5c2252281aa8f3bd92189176dd46ae9620ee68a --keepalived-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:a882a11b55b2fc41b538b59bf5db8e4cfc47c537890e4906fe6bf22f9da75575 --coredns-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:b25b8b2219e8c247c088af93e833c9ac390bc63459955e131d89b77c485d144d --mdns-publisher-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:dea1fcb456eae4aabdf5d2d5c537a968a2dafc3da52fe20e8d99a176fccaabce --haproxy-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:7064737dd9d0a43de7a87a094487ab4d7b9e666675c53cf4806d1c9279bd6c2e --baremetal-runtimecfg-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:715bc48eda04afc06827189883451958d8940ed8ab6dd491f602611fe98a6fba --cloud-config-file<span class=o>=</span>/assets/manifests/cloud-provider-config.yaml --cluster-etcd-operator-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9f7a02df3a5d91326d95e444e2e249f8205632ae986d6dccc7f007ec65c8af77
</span></span><span class=line><span class=cl>render --prefix<span class=o>=</span>cluster-ingress- --output-dir<span class=o>=</span>/assets/ingress-operator-manifests
</span></span><span class=line><span class=cl>/usr/bin/cluster-kube-scheduler-operator render --manifest-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:187b9d29fea1bde9f1785584b4a7bbf9a0b9f93e1323d92d138e61c861b6286c --asset-input-dir<span class=o>=</span>/assets/tls --asset-output-dir<span class=o>=</span>/assets/kube-scheduler-bootstrap --config-output-file<span class=o>=</span>/assets/kube-scheduler-bootstrap/config
</span></span><span class=line><span class=cl>/usr/bin/cluster-kube-controller-manager-operator render --manifest-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:187b9d29fea1bde9f1785584b4a7bbf9a0b9f93e1323d92d138e61c861b6286c --asset-input-dir<span class=o>=</span>/assets/tls --asset-output-dir<span class=o>=</span>/assets/kube-controller-manager-bootstrap --config-output-file<span class=o>=</span>/assets/kube-controller-manager-bootstrap/config --cluster-config-file<span class=o>=</span>/assets/manifests/cluster-network-02-config.yml
</span></span><span class=line><span class=cl>/usr/bin/cluster-kube-apiserver-operator render --manifest-etcd-serving-ca<span class=o>=</span>etcd-ca-bundle.crt --manifest-etcd-server-urls<span class=o>=</span>https://localhost:2379 --manifest-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:187b9d29fea1bde9f1785584b4a7bbf9a0b9f93e1323d92d138e61c861b6286c --manifest-operator-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:718ca346d5499cccb4de98c1f858c9a9a13bbf429624226f466c3ee2c14ebf40 --asset-input-dir<span class=o>=</span>/assets/tls --asset-output-dir<span class=o>=</span>/assets/kube-apiserver-bootstrap --config-output-file<span class=o>=</span>/assets/kube-apiserver-bootstrap/config --cluster-config-file<span class=o>=</span>/assets/manifests/cluster-network-02-config.yml
</span></span><span class=line><span class=cl>/usr/bin/cluster-config-operator render --config-output-file<span class=o>=</span>/assets/config-bootstrap/config --asset-input-dir<span class=o>=</span>/assets/tls --asset-output-dir<span class=o>=</span>/assets/config-bootstrap
</span></span><span class=line><span class=cl>/usr/bin/cluster-etcd-operator render --etcd-ca<span class=o>=</span>/assets/tls/etcd-ca-bundle.crt --etcd-metric-ca<span class=o>=</span>/assets/tls/etcd-metric-ca-bundle.crt --manifest-etcd-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:aba3c59eb6d088d61b268f83b034230b3396ce67da4f6f6d49201e55efebc6b2 --etcd-discovery-domain<span class=o>=</span>test.example.com --manifest-cluster-etcd-operator-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9f7a02df3a5d91326d95e444e2e249f8205632ae986d6dccc7f007ec65c8af77 --manifest-setup-etcd-env-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:31dfdca3584982ed5a82d3017322b7d65a491ab25080c427f3f07d9ce93c52e2 --manifest-kube-client-agent-image<span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:8eb481214103d8e0b5fe982ffd682f838b969c8ff7d4f3ed4f83d4a444fb841b --asset-input-dir<span class=o>=</span>/assets/tls --asset-output-dir<span class=o>=</span>/assets/etcd-bootstrap --config-output-file<span class=o>=</span>/assets/etcd-bootstrap/config --cluster-config-file<span class=o>=</span>/assets/manifests/cluster-network-02-config.yml
</span></span><span class=line><span class=cl>render --output-dir<span class=o>=</span>/assets/cvo-bootstrap --release-image<span class=o>=</span>registry.openshift4.example.com/ocp4/openshift4@sha256:4a461dc23a9d323c8bd7a8631bed078a9e5eec690ce073f78b645c83fb4cdf74
</span></span><span class=line><span class=cl>/usr/bin/grep -oP Managed /manifests/0000_12_etcd-operator_01_operator.cr.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ crictl pods
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>POD ID              CREATED             STATE               NAME                                                                  NAMESPACE                             ATTEMPT
</span></span><span class=line><span class=cl>17a978b9e7b1e       <span class=m>3</span> minutes ago       Ready               bootstrap-kube-apiserver-bootstrap.openshift4.example.com             kube-system                           <span class=m>24</span>
</span></span><span class=line><span class=cl>8a0f79f38787a       <span class=m>3</span> minutes ago       Ready               bootstrap-kube-scheduler-bootstrap.openshift4.example.com             kube-system                           <span class=m>4</span>
</span></span><span class=line><span class=cl>1a707da797173       <span class=m>3</span> minutes ago       Ready               bootstrap-kube-controller-manager-bootstrap.openshift4.example.com    kube-system                           <span class=m>4</span>
</span></span><span class=line><span class=cl>0461d2caa2753       <span class=m>3</span> minutes ago       Ready               cloud-credential-operator-bootstrap.openshift4.example.com            openshift-cloud-credential-operator   <span class=m>4</span>
</span></span><span class=line><span class=cl>ab6519286f65a       <span class=m>3</span> minutes ago       Ready               bootstrap-cluster-version-operator-bootstrap.openshift4.example.com   openshift-cluster-version             <span class=m>2</span>
</span></span><span class=line><span class=cl>457a7a46ec486       <span class=m>8</span> hours ago         Ready               bootstrap-machine-config-operator-bootstrap.openshift4.example.com    default                               <span class=m>0</span>
</span></span><span class=line><span class=cl>e4df49b4d36a1       <span class=m>8</span> hours ago         Ready               etcd-bootstrap-member-bootstrap.openshift4.example.com                openshift-etcd                        <span class=m>0</span>
</span></span></code></pre></div><p>如果验证无问题，则可以一边继续下面的步骤一边观察日志：<code>journalctl -b -f -u bootkube.service</code></p><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg></span></span><span class=dark:text-neutral-300>RHCOS 的默认用户是 <code>core</code>，如果想获取 root 权限，可以执行命令 <code>sudo su</code>（不需要输入密码）。</span></div><h3 class="relative group">Master<div id=master class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#master aria-label=锚点>#</a></span></h3><p>控制节点和之前类似，先创建虚拟机，然后修改引导参数，引导参数调整为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ip</span><span class=o>=</span>192.168.57.62::192.168.57.1:255.255.255.0:master1.openshift4.example.com:ens192:none <span class=nv>nameserver</span><span class=o>=</span>192.168.57.60 coreos.inst.install_dev<span class=o>=</span>sda coreos.inst.image_url<span class=o>=</span>http://192.168.57.60:8080/install/rhcos-4.4.3-x86_64-metal.x86_64.raw.gz coreos.inst.ignition_url<span class=o>=</span>http://192.168.57.60:8080/ignition/master.ign 
</span></span></code></pre></div><p>控制节点安装成功后会重启一次，之后同样可以从基础节点通过 SSH 密钥登录。</p><p>然后重复相同的步骤创建其他两台控制节点，注意修改引导参数（IP 和主机名）。先不急着创建计算节点，先在基础节点执行以下命令完成生产控制平面的创建：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openshift-install --dir<span class=o>=</span>/ocpinstall wait-for bootstrap-complete --log-level<span class=o>=</span>debug
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DEBUG OpenShift Installer 4.4.5
</span></span><span class=line><span class=cl>DEBUG Built from commit 15eac3785998a5bc250c9f72101a4a9cb767e494
</span></span><span class=line><span class=cl>INFO Waiting up to 20m0s <span class=k>for</span> the Kubernetes API at https://api.openshift4.example.com:6443...
</span></span><span class=line><span class=cl>INFO API v1.17.1 up
</span></span><span class=line><span class=cl>INFO Waiting up to 40m0s <span class=k>for</span> bootstrapping to complete...
</span></span><span class=line><span class=cl>DEBUG Bootstrap status: <span class=nb>complete</span>
</span></span><span class=line><span class=cl>INFO It is now safe to remove the bootstrap resources
</span></span></code></pre></div><p>待出现 <code>It is now safe to remove the bootstrap resources</code> 提示之后，从负载均衡器中删除引导主机，本文使用的是 Envoy，只需从 <code>cds.yaml</code> 中删除引导主机的 endpoint，然后重新加载就好了。</p><p>观察引导节点的日志：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ journalctl -b -f -u bootkube.service
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:12 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:12.108179       <span class=m>1</span> waitforceo.go:67<span class=o>]</span> waiting on condition EtcdRunningInCluster in etcd CR /cluster to be True.
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:21 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:21.595680       <span class=m>1</span> waitforceo.go:67<span class=o>]</span> waiting on condition EtcdRunningInCluster in etcd CR /cluster to be True.
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:26 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:26.250214       <span class=m>1</span> waitforceo.go:67<span class=o>]</span> waiting on condition EtcdRunningInCluster in etcd CR /cluster to be True.
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:26 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:26.306421       <span class=m>1</span> waitforceo.go:67<span class=o>]</span> waiting on condition EtcdRunningInCluster in etcd CR /cluster to be True.
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:29 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:29.097072       <span class=m>1</span> waitforceo.go:64<span class=o>]</span> Cluster etcd operator bootstrapped successfully
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:29 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: I0605 00:24:29.097306       <span class=m>1</span> waitforceo.go:58<span class=o>]</span> cluster-etcd-operator bootstrap etcd
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:29 bootstrap.openshift4.example.com podman<span class=o>[</span>16531<span class=o>]</span>: 2020-06-05 00:24:29.120864426 +0000 UTC <span class=nv>m</span><span class=o>=</span>+17.965364064 container died 77971b6ca31755a89b279fab6f9c04828c4614161c2e678c7cba48348e684517 <span class=o>(</span><span class=nv>image</span><span class=o>=</span>quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9f7a02df3a5d91326d95e444e2e249f8205632ae986d6dccc7f007ec65c8af77, <span class=nv>name</span><span class=o>=</span>recursing_cerf<span class=o>)</span>
</span></span><span class=line><span class=cl>Jun <span class=m>05</span> 00:24:29 bootstrap.openshift4.example.com bootkube.sh<span class=o>[</span>12571<span class=o>]</span>: bootkube.service <span class=nb>complete</span>
</span></span></code></pre></div><h3 class="relative group">Worker<div id=worker class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#worker aria-label=锚点>#</a></span></h3><p>计算节点和之前类似，先创建虚拟机，然后修改引导参数，引导参数调整为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ip</span><span class=o>=</span>192.168.57.65::192.168.57.1:255.255.255.0:worker1.openshift4.example.com:ens192:none <span class=nv>nameserver</span><span class=o>=</span>192.168.57.60 coreos.inst.install_dev<span class=o>=</span>sda coreos.inst.image_url<span class=o>=</span>http://192.168.57.60:8080/install/rhcos-4.4.3-x86_64-metal.x86_64.raw.gz coreos.inst.ignition_url<span class=o>=</span>http://192.168.57.60:8080/ignition/worker.ign 
</span></span></code></pre></div><p>计算节点安装成功后也会重启一次，之后同样可以从基础节点通过 SSH 密钥登录。</p><p>然后重复相同的步骤创建其他计算节点，注意修改引导参数（IP 和主机名）。</p><h3 class="relative group">登录集群<div id=登录集群 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e7%99%bb%e5%bd%95%e9%9b%86%e7%be%a4 aria-label=锚点>#</a></span></h3><p>可以通过导出集群 kubeconfig 文件以默认系统用户身份登录到集群。kubeconfig 文件包含有关 CLI 用于将客户端连接到正确的集群和 API Server 的集群信息，该文件在 OCP 安装期间被创建。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir ~/.kube
</span></span><span class=line><span class=cl>$ cp /ocpinstall/auth/kubeconfig ~/.kube/config
</span></span><span class=line><span class=cl>$ oc whoami
</span></span><span class=line><span class=cl>system:admin
</span></span></code></pre></div><h3 class="relative group">批准 CSR<div id=批准-csr class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e6%89%b9%e5%87%86-csr aria-label=锚点>#</a></span></h3><p>将节点添加到集群时，会为添加的每台节点生成<strong>两个</strong>待处理证书签名请求（CSR）。必须确认这些 CSR 已获得批准，或者在必要时自行批准。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc get node
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                             STATUS   ROLES           AGE     VERSION
</span></span><span class=line><span class=cl>master1.openshift4.example.com   Ready    master,worker   6h25m   v1.17.1
</span></span><span class=line><span class=cl>master2.openshift4.example.com   Ready    master,worker   6h39m   v1.17.1
</span></span><span class=line><span class=cl>master3.openshift4.example.com   Ready    master,worker   6h15m   v1.17.1
</span></span><span class=line><span class=cl>worker1.openshift4.example.com   NotReady worker          5h8m    v1.17.1
</span></span><span class=line><span class=cl>worker2.openshift4.example.com   NotReady worker          5h9m    v1.17.1
</span></span></code></pre></div><p>输出列出了创建的所有节点。查看挂起的证书签名请求（CSR），并确保添加到集群的每台节点都能看到具有 <code>Pending</code> 或 <code>Approved</code> 状态的客户端和服务端请求。针对 Pending 状态的 CSR 批准请求：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc adm certificate approve xxx
</span></span></code></pre></div><p>或者执行以下命令批准所有 CSR：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc get csr -ojson <span class=p>|</span> jq -r <span class=s1>&#39;.items[] | select(.status == {} ) | .metadata.name&#39;</span> <span class=p>|</span> xargs oc adm certificate approve
</span></span></code></pre></div><h3 class="relative group">Operator 自动初始化<div id=operator-自动初始化 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#operator-%e8%87%aa%e5%8a%a8%e5%88%9d%e5%a7%8b%e5%8c%96 aria-label=锚点>#</a></span></h3><p>控制平面初始化后，需要确认所有的 <code>Operator</code> 都处于可用的状态，即确认所有 Operator 的 <code>Available</code> 字段值皆为 <code>True</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc get clusteroperators
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                       VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE
</span></span><span class=line><span class=cl>authentication                             4.4.5     True        False         False      150m
</span></span><span class=line><span class=cl>cloud-credential                           4.4.5     True        False         False      7h7m
</span></span><span class=line><span class=cl>cluster-autoscaler                         4.4.5     True        False         False      6h12m
</span></span><span class=line><span class=cl>console                                    4.4.5     True        False         False      150m
</span></span><span class=line><span class=cl>csi-snapshot-controller                    4.4.5     True        False         False      6h13m
</span></span><span class=line><span class=cl>dns                                        4.4.5     True        False         False      6h37m
</span></span><span class=line><span class=cl>etcd                                       4.4.5     True        False         False      6h19m
</span></span><span class=line><span class=cl>image-registry                             4.4.5     True        False         False      6h12m
</span></span><span class=line><span class=cl>ingress                                    4.4.5     True        False         False      150m
</span></span><span class=line><span class=cl>insights                                   4.4.5     True        False         False      6h13m
</span></span><span class=line><span class=cl>kube-apiserver                             4.4.5     True        False         False      6h15m
</span></span><span class=line><span class=cl>kube-controller-manager                    4.4.5     True        False         False      6h36m
</span></span><span class=line><span class=cl>kube-scheduler                             4.4.5     True        False         False      6h36m
</span></span><span class=line><span class=cl>kube-storage-version-migrator              4.4.5     True        False         False      6h36m
</span></span><span class=line><span class=cl>machine-api                                4.4.5     True        False         False      6h37m
</span></span><span class=line><span class=cl>machine-config                             4.4.5     True        False         False      6h36m
</span></span><span class=line><span class=cl>marketplace                                4.4.5     True        False         False      6h12m
</span></span><span class=line><span class=cl>monitoring                                 4.4.5     True        False         False      6h6m
</span></span><span class=line><span class=cl>network                                    4.4.5     True        False         False      6h39m
</span></span><span class=line><span class=cl>node-tuning                                4.4.5     True        False         False      6h38m
</span></span><span class=line><span class=cl>openshift-apiserver                        4.4.5     True        False         False      6h14m
</span></span><span class=line><span class=cl>openshift-controller-manager               4.4.5     True        False         False      6h12m
</span></span><span class=line><span class=cl>openshift-samples                          4.4.5     True        False         False      6h11m
</span></span><span class=line><span class=cl>operator-lifecycle-manager                 4.4.5     True        False         False      6h37m
</span></span><span class=line><span class=cl>operator-lifecycle-manager-catalog         4.4.5     True        False         False      6h37m
</span></span><span class=line><span class=cl>operator-lifecycle-manager-packageserver   4.4.5     True        False         False      6h15m
</span></span><span class=line><span class=cl>service-ca                                 4.4.5     True        False         False      6h38m
</span></span><span class=line><span class=cl>service-catalog-apiserver                  4.4.5     True        False         False      6h38m
</span></span><span class=line><span class=cl>service-catalog-controller-manager         4.4.5     True        False         False      6h39m
</span></span><span class=line><span class=cl>storage                                    4.4.5     True        False         False      6h12m
</span></span></code></pre></div><p>如果 Operator 不正常，需要进行问题诊断和修复。</p><h3 class="relative group">完成安装<div id=完成安装 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%8c%e6%88%90%e5%ae%89%e8%a3%85 aria-label=锚点>#</a></span></h3><p>最后一步，完成集群的安装，执行以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openshift-install --dir<span class=o>=</span>/ocpinstall wait-for install-complete --log-level<span class=o>=</span>debug
</span></span></code></pre></div><p>注意最后提示访问 <code>Web Console</code> 的网址及用户密码。如果密码忘了也没关系，可以查看文件 <code>/ocpinstall/auth/kubeadmin-password</code> 来获得密码。</p><p>本地访问 Web Console，需要添加 hosts：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>192.168.57.60 console-openshift-console.apps.openshift4.example.com
</span></span><span class=line><span class=cl>192.168.57.60 oauth-openshift.apps.openshift4.example.com
</span></span></code></pre></div><p>浏览器访问 <code>https://console-openshift-console.apps.openshift4.example.com</code>，输入上面输出的用户名密码登录。首次登录后会提示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>You are logged in as a temporary administrative user. Update the Cluster OAuth configuration to allow others to log in.
</span></span></code></pre></div><p>我们可以通过 htpasswd 自定义管理员账号，步骤如下：</p><p>① <code>htpasswd -c -B -b users.htpasswd admin xxxxx</code></p><p>② 将 <code>users.htpasswd</code> 文件下载到本地。</p><p>③ 在 Web Console 页面打开 <code>Global Configuration</code>：</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605150947.png alt></figure></p><p>然后找到 <code>OAuth</code>，点击进入，然后添加 <code>HTPasswd</code> 类型的 <code>Identity Providers</code>，并上传 <code>users.htpasswd</code> 文件。</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605151307.png alt></figure></p><p>④ 退出当前用户，注意要退出到如下界面：</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605151646.png alt></figure></p><p>选择 <code>htpasswd</code>，然后输入之前创建的用户名密码登录。</p><p>如果退出后出现的就是用户密码输入窗口，实际还是 <code>kube:admin</code> 的校验，如果未出现如上提示，可以手动输入 Web Console 地址来自动跳转。</p><p>⑤ 登录后貌似能看到 <code>Administrator</code> 菜单项，但访问如 <code>OAuth Details</code> 仍然提示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oauths.config.openshift.io <span class=s2>&#34;cluster&#34;</span> is forbidden: User <span class=s2>&#34;admin&#34;</span> cannot get resource <span class=s2>&#34;oauths&#34;</span> in API group <span class=s2>&#34;config.openshift.io&#34;</span> at the cluster scope
</span></span></code></pre></div><p>因此需要授予集群管理员权限：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc adm policy add-cluster-role-to-user cluster-admin admin
</span></span></code></pre></div><p>Web Console 部分截图：</p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605152528.png alt></figure></p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605152729.png alt></figure></p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605152911.png alt></figure></p><p><figure><img loading=lazy class="my-0 rounded-md" src=https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/img/20200605153048.png alt></figure></p><p>如果想删除默认账号，可以执行以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ oc -n kube-system delete secrets kubeadmin
</span></span></code></pre></div><h2 class="relative group">8. 参考资料<div id=8-参考资料 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#8-%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 aria-label=锚点>#</a></span></h2><ul><li><a href=https://www.openshift.com/blog/openshift-4-2-vsphere-install-with-static-ips target=_blank>OpenShift 4.2 vSphere Install with Static IPs</a></li><li><a href=https://blog.csdn.net/scwang18/article/details/104222408 target=_blank>OpenShift Container Platform 4.3部署实录</a></li><li><a href=https://access.redhat.com/documentation/en-us/openshift_container_platform/4.4/html/installing_on_bare_metal/installing-on-bare-metal target=_blank>Chapter 1. Installing on bare metal</a></li></ul></div><div class="text-neutral-700 dark:text-neutral-300" style=text-align:center;font-size:16px;font-family:cursive>-------他日江湖相逢
<span class="relative icon" style=display:inline-block><svg version="1.0" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="800" viewBox="0 0 64 64" enable-background="new 0 0 64 64"><g><path fill="#394240" d="M35 4.145V3.002 3c0-1.656-1.343-3-3-3s-3 1.344-3 3v.002 1.143C12.734 5.658.0 19.338.0 36c0 0 0 1 1 1s1.867-1 1.867-1C4.68 34.15 7.204 33 10 33c4.1.0 7.618 2.469 9.162 6 0 0 .541 1 1.838 1s1.838-1 1.838-1c1.15-2.629 3.396-4.668 6.162-5.539V56c0 4.418 3.582 8 8 8s8-3.582 8-8c0-1.656-1.343-3-3-3s-3 1.344-3 3c0 1.104-.896 2-2 2s-2-.896-2-2V33.461c2.766.871 5.012 2.91 6.162 5.539.0.0.541 1 1.838 1s1.838-1 1.838-1c1.544-3.531 5.062-6 9.162-6 2.796.0 5.319 1.15 7.133 3 0 0 .867 1 1.867 1s1-1 1-1C64 19.338 51.266 5.658 35 4.145zM31 3c0-.553.447-1 1-1s1 .447 1 1v1.025C32.667 4.016 32.335 4 32 4s-.667.016-1 .025V3zM10 31c-3.047.0-5.816 1.145-7.928 3.018C3.006 19.729 13.94 8.17 27.947 6.277 22.911 14.678 20 24.492 20 35v1.387C17.853 33.145 14.181 31 10 31zM37 60c2.209.0 4-1.791 4-4 0-.553.447-1 1-1s1 .447 1 1c0 3.312-2.687 6-6 6s-6-2.688-6-6V33.055C31.329 33.023 31.662 33 32 33s.671.023 1 .055V56c0 2.209 1.791 4 4 4zM32 31c-4.181.0-7.853 2.145-10 5.387V35c0-10.662 3.113-20.588 8.449-28.959.5-.025 1.004-.039 1.511-.039h.08c.507.0 1.011.014 1.511.039C38.887 14.412 42 24.338 42 35v1.387C39.853 33.145 36.181 31 32 31zm22 0c-4.181.0-7.853 2.145-10 5.387V35c0-10.508-2.911-20.322-7.947-28.723C50.06 8.17 60.994 19.729 61.928 34.018 59.816 32.145 57.047 31 54 31z"/><path fill="#f9ebb2" d="M31 3c0-.553.447-1 1-1s1 .447 1 1v1.025C32.667 4.016 32.335 4 32 4s-.667.016-1 .025V3z"/><g><path fill="#45aab8" d="M2.072 34.018C4.184 32.145 6.953 31 10 31c4.181.0 7.853 2.145 10 5.387V35c0-10.508 2.911-20.322 7.947-28.723C13.94 8.17 3.006 19.729 2.072 34.018z"/><path fill="#45aab8" d="M36.053 6.277C41.089 14.678 44 24.492 44 35v1.387C46.147 33.145 49.819 31 54 31c3.047.0 5.816 1.145 7.928 3.018C60.994 19.729 50.06 8.17 36.053 6.277z"/></g><path fill="#b4ccb9" d="M32.04 6.002h-.08c-.507.0-1.011.014-1.511.039C25.113 14.412 22 24.338 22 35v1.387C24.147 33.145 27.819 31 32 31s7.853 2.145 10 5.387V35c0-10.662-3.113-20.588-8.449-28.959C33.051 6.016 32.547 6.002 32.04 6.002z"/><path fill="#f9ebb2" d="M37 60c2.209.0 4-1.791 4-4 0-.553.447-1 1-1s1 .447 1 1c0 3.312-2.687 6-6 6s-6-2.688-6-6V33.055C31.329 33.023 31.662 33 32 33s.671.023 1 .055V56c0 2.209 1.791 4 4 4z"/></g></svg></span>再当杯酒言欢-------</div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;title=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title="分享到 LinkedIn" aria-label="分享到 LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;text=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title="分享到 Twitter" aria-label="分享到 Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;resubmit=true&amp;title=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title="提交到 Reddit" aria-label="提交到 Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;resubmit=true&amp;title=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;resubmit=true&amp;title=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;description=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title="钉到 Pinterest" aria-label="钉到 Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;quote=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title="分享到 Facebook" aria-label="分享到 Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://icloudnative.io/posts/openshift4.4-install-offline-static-2-first-setup/&amp;subject=Openshift%204.4%20%e9%9d%99%e6%80%81%20IP%20%e7%a6%bb%e7%ba%bf%e5%ae%89%e8%a3%85%e7%b3%bb%e5%88%97%ef%bc%9a%e5%88%9d%e5%a7%8b%e5%ae%89%e8%a3%85" title=通过电子邮件发送 aria-label=通过电子邮件发送><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">相关文章</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><a href=/posts/openshift4.4-install-offline-static-1-requirement/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/openshift4.4-install-offline-static-1-requirement/featured_hud65c77d60b44ce1ca1267403fddda9a8_5062_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/openshift4.4-install-offline-static-1-requirement/>Openshift 4.4 静态 IP 离线安装系列：准备离线资源</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-05-28 21:44:45 +0800 +0800">2020年5月28日</time><span class="px-2 text-primary-500">&#183;</span><span>4397 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>9 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/openshift/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Openshift
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/quay/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Quay</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/why-does-my-docker-container-take-10-seconds-to-stop/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/why-does-my-docker-container-take-10-seconds-to-stop/featured_hufd2b4e0a721103d1fad58b1cf2532639_12353_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/why-does-my-docker-container-take-10-seconds-to-stop/>Docker 容器优雅终止方案</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-05-27 09:44:49 +0800 +0800">2020年5月27日</time><span class="px-2 text-primary-500">&#183;</span><span>1858 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>4 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/docker/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/how-it-works-kubectl-exec/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/how-it-works-kubectl-exec/featured_hu719e1832dbce76cb9d3c7203ebfaa131_7787_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/how-it-works-kubectl-exec/>Kubectl exec 的工作原理解读</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-05-21 10:02:29 +0800 +0800">2020年5月21日</time><span class="px-2 text-primary-500">&#183;</span><span>2986 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>6 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/kubelet/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Kubelet
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/kubernetes/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Kubernetes</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/docker-images-part2-details-specific-to-different-languages/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/docker-images-part2-details-specific-to-different-languages/featured_hu320221e935392983da006c01b697fac8_12047_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/docker-images-part2-details-specific-to-different-languages/>Docker 镜像制作教程：针对不同语言的精简策略</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-05-16 12:17:31 +0800 +0800">2020年5月16日</time><span class="px-2 text-primary-500">&#183;</span><span>6229 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>13 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/docker/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/docker-registry-proxy/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/docker-registry-proxy/featured_hue8f98f918e8d1fcd93805b10d792896c_10744_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/docker-registry-proxy/>Docker 镜像加速教程</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-05-11 21:46:44 +0800 +0800">2020年5月11日</time><span class="px-2 text-primary-500">&#183;</span><time datetime="2021-02-17 17:46:44 +0800 +0800">更新于: 2021年2月17日</time><span class="px-2 text-primary-500">&#183;</span><span>4627 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>10 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/docker/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/envoy/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Envoy</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/docker-images-part1-reducing-image-size/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/docker-images-part1-reducing-image-size/featured_hu384f6bc71784b8ea95d6d466bf424683_9870_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/docker-images-part1-reducing-image-size/>Docker 镜像制作教程：减小镜像体积</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2020-03-19 23:25:39 +0800 +0800">2020年3月19日</time><span class="px-2 text-primary-500">&#183;</span><span>4887 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>10 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/cloud-native/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">云原生
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/docker/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker</span></span></span></div></div></div><div class="px-6 pt-4 pb-2"></div></div></a></section></div><script>var oid="views_posts/openshift4.4-install-offline-static-2-first-setup/index.md",oid_likes="likes_posts/openshift4.4-install-offline-static-2-first-setup/index.md"</script><script type=text/javascript src=/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/openshift4.4-install-offline-static-1-requirement/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Openshift 4.4 静态 IP 离线安装系列：准备离线资源</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2020-05-28 21:44:45 +0800 +0800">2020年5月28日</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/vmware-fusion-11-5-now-supports-containers/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">VMware Fusion 管理 Docker 容器教程</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2020-06-08 16:04:25 +0800 +0800">2020年6月8日</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div><div class=pt-3><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=pt-3><img loading=lazy src=/img/wechat-qr.webp alt=公众号二维码><div id=comment></div><script>document.addEventListener("DOMContentLoaded",function(){var t="/js/iDisqus.min.js",e=new IntersectionObserver(function(n){if(n[0].isIntersecting){var s,o=document.createElement("link");o.rel="stylesheet",o.href="/css/iDisqus.min.css",document.head.appendChild(o),s=document.createElement("script"),s.src=t,s.onload=function(){var e=new iDisqus("comment",{forum:"fuckcloudnative",api:"https://disqus.icloudnative.io",site:"https://icloudnative.io",emojiPath:"https://jsdelivr.icloudnative.io/gh/yangchuansheng/imghosting@master/emoji/",mode:2,timeout:15,init:!0})},document.body.appendChild(s),e.disconnect()}},{threshold:[.1]});e.observe(document.getElementById("comment"))})</script></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label title>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden" style=margin-inline:auto;text-align:center><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=标签>标签</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/categories/ title=分类>分类</a></li></ul></nav><div class="items-center justify-between"></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script><div class=busuanzi style=margin-inline:auto;text-align:center><div class=busuanzi__item><span class="busuanzi__item--label text-neutral-500 dark:text-neutral-400">总访客</span>
<span id=busuanzi_site_uv class="busuanzi__item--number text-neutral-500 dark:text-neutral-400"></span></div><div class=busuanzi__item><span class="busuanzi__item--label text-neutral-500 dark:text-neutral-400">总浏览量</span>
<span id=busuanzi_site_pv class="busuanzi__item--number text-neutral-500 dark:text-neutral-400"></span></div></div><p class="text-sm text-neutral-500 dark:text-neutral-400" style=margin-inline:auto;text-align:center>&copy; 2023 米开朗基杨<br>本站内容依据
<a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh target=_blank>CC BY-SA 4.0</a>
许可证进行授权，转载请附上出处链接。</p><div class=github-badge><span class=badge-subject>构建工具</span><span class="badge-value bg-blue"><a style=color:#fff href=https://gohugo.io/ target=_blank>Hugo v0.120.4</a></span>
<span class=badge-subject>托管于</span><span class="badge-value bg-brightgreen"><a style=color:#fff href=https://sealos.run target=_blank>Sealos</a></span>
<span class=badge-subject>CDN</span><span class="badge-value bg-blueviolet"><a style=color:#fff href=https://vercel.com target=_blank>Vercel</a></span>
<span class=badge-subject>图床</span><span class="badge-value bg-orange"><a style=color:#fff href=https://www.jsdelivr.com/ target=_blank>jsDelivr</a></span>
<span class=badge-subject>主题</span><span class="badge-value bg-blue"><a style=color:#fff href=https://github.com/nunocoracao/blowfish target=_blank>Blowfish</a></span></div><section class="text-sm text-neutral-500 dark:text-neutral-400"><span id=span_dt_dt></span><script defer language=javascript>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("10/8/2019 10:56:12"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=24*60*60*1e3,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=(e_daysold-daysold)*24,hrsold=Math.floor(e_hrsold),e_minsold=(e_hrsold-hrsold)*60,minsold=Math.floor((e_hrsold-hrsold)*60),seconds=Math.floor((e_minsold-minsold)*60),span_dt_dt.innerHTML="本站已经开心运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}show_date_time()</script></section><style>.wxtip{background:rgba(0,0,0,.8);text-align:center;position:fixed;left:0;top:0;width:100%;height:100%;z-index:998;display:none}.wxtip-icon{width:52px;height:67px;background:url(img/weixin-tip.png)no-repeat;display:block;position:absolute;right:20px;top:20px}.wxtip-txt{margin-top:107px;color:#fff;font-size:16px;line-height:1.5}</style><div class=wxtip id=JweixinTip><span class=wxtip-icon></span><p class=wxtip-txt>点击屏幕右上角的 ···<br>在弹出的窗口中选择 <span style=color:red>在浏览器中打开</span></p><br><br><p><img loading=lazy style=width:85%;border-radius:10px;display:block;margin-left:auto;margin-right:auto src=/img/wechat-browser.jpg></p></div><script defer>is_weixn_qq()&&(document.getElementById("JweixinTip").style.display="block",document.getElementById("container").style.display="none",document.getElementById("top-grrk").style.display="none");function is_weixn_qq(){var e=navigator.userAgent,t=!!/MicroMessenger/i.test(e),n=!!/QQ\//i.test(e);return!!(t||n)}</script><div id=fixed-box><div class=feedback-btn-wrapper><a data-umami-event=FastGPT href=https://github.com/labring/FastGPT style=text-decoration:none target=_blank><button id=feedback-btn title=FastGPT>
<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="currentcolor"><path d="M320 0c17.7.0 32 14.3 32 32V96H472c39.8.0 72 32.2 72 72V440c0 39.8-32.2 72-72 72H168c-39.8.0-72-32.2-72-72V168c0-39.8 32.2-72 72-72H288V32c0-17.7 14.3-32 32-32zM208 384c-8.8.0-16 7.2-16 16s7.2 16 16 16h32c8.8.0 16-7.2 16-16s-7.2-16-16-16H208zm96 0c-8.8.0-16 7.2-16 16s7.2 16 16 16h32c8.8.0 16-7.2 16-16s-7.2-16-16-16H304zm96 0c-8.8.0-16 7.2-16 16s7.2 16 16 16h32c8.8.0 16-7.2 16-16s-7.2-16-16-16H4e2zM264 256a40 40 0 10-80 0 40 40 0 1080 0zm152 40a40 40 0 100-80 40 40 0 100 80zM48 224H64V416H48c-26.5.0-48-21.5-48-48V272c0-26.5 21.5-48 48-48zm544 0c26.5.0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H576V224h16z"/></svg><span _msttexthash=6039839 _msthash=295>AI 客服</span></button></a></div></div><script defer src=https://ymvhjeyojtri.cloud.sealos.top/js></script><script>document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("busuanzi_site_uv"),o=document.getElementById("busuanzi_site_pv"),e=new MutationObserver(t=>{for(let n of t)if(n.type==="childList"){e.disconnect(),n.target.innerHTML=parseInt(n.target.innerHTML)+731632;break}}),t=new MutationObserver(e=>{for(let n of e)if(n.type==="childList"){t.disconnect(),n.target.innerHTML=parseInt(n.target.innerHTML)+1360325;break}}),n={childList:!0};e.observe(s,n),t.observe(o,n)})</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",e=>{var n=["Docker","Kubernetes","Prometheus","Sealos","FastGPT","Envoy","eBPF","Laf","Webassembly","WireGuard","Tailscale","Cloud Native"],t=0;document.body.addEventListener("click",function(e){var s,o,i,a,r,l=n[t];t=(t+1)%n.length,s=document.createElement("span"),s.textContent=l,s.style.cssText=`
            z-index: 9999;
            top: ${e.pageY-20}px;
            left: ${e.pageX}px;
            position: absolute;
            font-weight: bold;
            color: ${randomColor()};
            opacity: 1;
            transition: opacity 1.5s;
        `,document.body.appendChild(s),o=null,a=1500,i=e.pageY-20,r=i-160;function c(e){o===null&&(o=e);var t=(e-o)/a;t<1?(s.style.top=i-t*(i-r)+"px",requestAnimationFrame(c)):s.remove()}requestAnimationFrame(c)})});function randomColor(){var e=["#FFDA65","#00BFFF","#cb80ff","#acc2ef","#87CEEB","#FFB6C1"];return e[Math.floor(Math.random()*e.length)]}</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://icloudnative.io style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title>
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>