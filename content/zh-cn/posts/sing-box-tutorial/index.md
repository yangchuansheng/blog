---
keywords:
- sing-box
- ç¿»å¢™
- Shadowsocks
- clash
- v2ray
- trojan
- vmess
- é€æ˜ç½‘å…³
- æ™ºèƒ½åˆ†æµ
pinned: true
title: "sing-box åŸºç¡€æ•™ç¨‹ï¼šsing-box çš„é…ç½®æ–¹æ³•å’Œä½¿ç”¨æ•™ç¨‹"
date: 2024-01-14T14:06:37+08:00
lastmod: 2024-01-14T14:06:37+08:00
description: å…¨é¢è§£æ sing-boxï¼šè¶…è¶Š *ray core å’Œ clash çš„ä¸‹ä¸€ä»£é€šç”¨ä»£ç†å·¥å…·ã€‚äº†è§£å…¶æ”¯æŒçš„ä¸°å¯Œåè®®ï¼Œå…è´¹å®¢æˆ·ç«¯ï¼Œä»¥åŠå¦‚ä½•è½»æ¾è®¾ç½®å…¨å±€é€æ˜ä»£ç†ã€‚é€‚ç”¨äº Androidã€iOSã€macOSï¼ŒLinuxï¼ŒåŠæ›´å¤šå¹³å°ã€‚
draft: false
author: ç±³å¼€æœ—åŸºæ¨
hideToc: false
enableToc: true
enableTocContent: false
tocFolding: false
tocLevels: ["h2", "h3", "h4"]
tags:
- sing-box
categories: 
- GFW
---

## sing-box æ˜¯ä»€ä¹ˆ

[sing-box](https://github.com/SagerNet/sing-box) æ˜¯æ–°ä¸€ä»£è¶…å¼ºé€šç”¨ä»£ç†å·¥å…·ï¼Œå¯¹æ ‡ *ray core ä¸ clashï¼Œè€Œä¸”å®ƒçš„æ€§èƒ½ä»¥åŠæ”¯æŒçš„åè®®ç±»å‹å·²ç»è¶…è¿‡äº† *ray core ä¸ clashã€‚ç›®å‰æ”¯æŒä»¥ä¸‹åè®®ï¼š

å…¥ç«™ï¼š

- Shadowsocks(including shadowsocks2022)
- Vmess
- Trojan
- Naive
- Hysteria
- ShadowTLS
- Vless
- Tuic
- Tun
- Redirect
- TProxy
- Socks
- HTTP

å‡ºç«™ï¼š

- Shadowsocks(including shadowsocks2022)
- Vmess
- Trojan
- Wireguard
- Hysteria
- ShadowTLS
- ShadowsocksR
- VLESS
- Tuic
- Hysteria2
- Tor
- SSH
- DNS

é™¤äº†å‘½ä»¤è¡Œå®¢æˆ·ç«¯ä»¥å¤–ï¼Œè¿˜æä¾›äº†å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯ï¼Œå›¾å½¢ç•Œé¢æ”¯æŒ Androidã€iOSã€macOS ä»¥åŠ Apple tvOSï¼ŒWindows æš‚æ—¶ä¸æ”¯æŒï¼Œè¿˜åœ¨æ–½å·¥ä¸­ ğŸš§

![](https://images.icloudnative.io/uPic/2023-12-30-17-31-gSoqhd.jpg)

è¿™ç®€ç›´å°±æ˜¯é­”æ³•ä¸Šç½‘ç•Œçš„ç‘å£«å†›åˆ€å•Šï¼è€Œä¸”**æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½æ˜¯å…è´¹çš„**ï¼ŒiOS ç«¯ä¹Ÿä¸ç”¨å†ä¹° Shadowrocket å°ç«ç®­ç­‰ä»˜è´¹ App äº†ã€‚å†çœ‹çœ‹éš”å£ Surge çš„ä»·æ ¼ï¼š

![](https://images.icloudnative.io/uPic/2023-12-30-17-37-yTvKLW.jpg)

ä½ ç©æˆ‘å‘¢ï¼Ÿï¼Ÿ

è¿˜æ˜¯ sing-box é¦™ã€‚æœ¬æ–‡å°†ä¼šæ‰‹æŠŠæ‰‹æ•™å¤§å®¶å¦‚ä½•ä½¿ç”¨ sing-box æ¥å®ç°ä»»æ„æœºå™¨çš„å…¨å±€é€æ˜ä»£ç†ã€‚

## sing-box å®¢æˆ·ç«¯ä¸‹è½½

ç¬¬ä¸€æ­¥å…ˆè§£å†³å®¢æˆ·ç«¯ä¸‹è½½çš„é—®é¢˜ã€‚

### Android

Android å®¢æˆ·ç«¯å¯ä»¥åˆ° [Play Store](https://play.google.com/store/apps/details?id=io.nekohasekai.sfa) ä¸­å»ä¸‹è½½ï¼š

![](https://images.icloudnative.io/uPic/2023-12-30-17-54-a8vZ24.webp)

ä¹Ÿå¯ä»¥ç›´æ¥åˆ° [GitHub Releases](https://github.com/SagerNet/sing-box/releases) é¡µé¢ä¸‹è½½ã€‚

å¦‚æœä½ æ˜¯ Android çš„ Magisk/KernelSU ç©å®¶ï¼Œå¯ä»¥é€‰æ‹©åˆ·å…¥ [box_for_magisk æ¨¡å—](https://github.com/taamarin/box_for_magisk)ã€‚

### Apple å¹³å°

iOS/macOS/Apple tvOS ç”¨æˆ·å¯ä»¥åˆ° [App Store](https://apps.apple.com/us/app/sing-box/id6451272673) ä¸­ä¸‹è½½ï¼ˆå‰ææ˜¯ä½ å¾—æœ‰ä¸ªç¾åŒº IDï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Homebrew ç›´æ¥å®‰è£…ï¼š

```bash
$ brew install sfm
```

é™¤æ­¤ä¹‹å¤–ä½ ä¹Ÿå¯ä»¥ç›´æ¥åˆ° [GitHub Releases](https://github.com/SagerNet/sing-box/releases) é¡µé¢ä¸‹è½½å®¢æˆ·ç«¯æˆ–è€…å‘½ä»¤è¡Œç‰ˆæœ¬ã€‚

### Windows

Windows æ²¡æœ‰å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯ï¼Œå®˜æ–¹è¿˜æ­£åœ¨å¼€å‘ä¸­ï¼Œä¸è¿‡å¯ä»¥ç›´æ¥ä½¿ç”¨åŒ…ç®¡ç†å™¨ Sccop æˆ–è€… Chocolatey å®‰è£…å‘½ä»¤è¡Œç‰ˆæœ¬ï¼š

```bash
# Sccop
$ scoop install sing-box

# Chocolatey
$ choco install sing-box
```

ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ç¬¬ä¸‰æ–¹å¼€å‘è€…å¼€å‘çš„å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯ï¼š[GUI.for.SingBox](https://github.com/GUI-for-Cores/GUI.for.SingBox)

![](https://images.icloudnative.io/uPic/2024-01-19-17-28-IrwTam.png)

è¿˜æœ‰ä¸€ä¸ªæ›´åŠ æˆç†Ÿçš„ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼š[Hiddify-Next](https://github.com/hiddify/hiddify-next)

### Linux

Linux å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥åˆ° [GitHub Releases](https://github.com/SagerNet/sing-box/releases) é¡µé¢ä¸‹è½½å‘½ä»¤è¡Œç‰ˆæœ¬å³å¯ã€‚

## sing-box é…ç½®è§£æ

sing-box çš„æ ¸å¿ƒå°±æ˜¯å®ƒçš„é…ç½®ï¼Œæ‰€æœ‰çš„é…ç½®éƒ½åœ¨ä¸€ä¸ª JSON æ–‡ä»¶é‡Œï¼Œæ¯ä¸ªé…ç½®å‚æ•°çš„å«ä¹‰å¯å‚è€ƒ [sing-box å®˜æ–¹æ–‡æ¡£](https://sing-box.sagernet.org/)ã€‚

ä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿä½¿ç”¨èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¤ºä¾‹æ¨¡æ¿ã€‚æ²¡é—®é¢˜ï¼Œæˆ‘è¿™å°±ç»™ä½ ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„é€æ˜ä»£ç†æ¨¡æ¿ï¼š

{{< details title="sing-box é€æ˜ä»£ç†ç¤ºä¾‹æ¨¡æ¿" closed="true" >}}
```json
{
  "dns": {
    "servers": [
      {
        "tag": "dns_proxy",
        "address": "https://1.1.1.1/dns-query",
        "address_resolver": "dns_resolver",
        "strategy": "ipv4_only",
        "detour": "select"
      },
      {
        "tag": "dns_direct",
        "address": "h3://dns.alidns.com/dns-query",
        "address_resolver": "dns_resolver",
        "strategy": "ipv4_only",
        "detour": "direct"
      },
      {
        "tag": "dns_block",
        "address": "rcode://refused"
      },
      {
        "tag": "dns_resolver",
        "address": "223.5.5.5",
        "strategy": "ipv4_only",
        "detour": "direct"
      }
    ],
    "rules": [
      {
        "outbound": "any",
        "server": "dns_resolver"
      },
      {
        "clash_mode": "direct",
        "server": "dns_direct"
      },
      {
        "clash_mode": "global",
        "server": "dns_proxy"
      },
      {
        "process_name": [
          "TencentMeeting",
          "NemoDesktop",
          "ToDesk",
          "ToDesk_Service",
          "WeChat",
          "Tailscale",
          "wireguard-go",
          "Tunnelblick",
          "softwareupdated",
          "kubectl"
        ],
        "server": "dns_direct"
      },
      {
        "domain_suffix": [
          "icloudnative.io",
          "fuckcloudnative.io",
          "sealos.io",
          "cdn.jsdelivr.net"
        ],
        "server": "dns_direct"
      },
      {
        "process_name": [
          "DropboxMacUpdate",
          "Dropbox"
        ],
        "server": "dns_proxy"
      },
      {
        "package_name": [
          "com.google.android.youtube",
          "com.android.vending",
          "org.telegram.messenger",
          "org.telegram.plus"
        ],
        "server": "dns_proxy"
      },
      {
        "rule_set": "geosite-geolocation-!cn",
        "server": "dns_proxy"
      },
      {
        "rule_set": "Global",
        "server": "dns_proxy"
      },
      {
        "rule_set": [
          "YouTube",
          "Telegram",
          "Netflix",
          "geoip-google",
          "geoip-telegram",
          "geoip-twitter",
          "geoip-netflix"
        ],
        "server": "dns_proxy"
      }
    ],
    "final": "dns_direct"
  },
  "ntp": {
    "enabled": true,
    "server": "time.apple.com",
    "server_port": 123,
    "interval": "30m0s",
    "detour": "direct"
  },
  "inbounds": [
    {
      "type": "tun",
      "inet4_address": "198.18.0.1/16",
      "auto_route": true,
      "exclude_package": [
        "cmb.pb",
        "cn.gov.pbc.dcep",
        "com.MobileTicket",
        "com.adguard.android",
        "com.ainemo.dragoon",
        "com.alibaba.android.rimet",
        "com.alicloud.databox",
        "com.amazing.cloudisk.tv",
        "com.autonavi.minimap",
        "com.bilibili.app.in",
        "com.bishua666.luxxx1",
        "com.cainiao.wireless",
        "com.chebada",
        "com.chinamworld.main",
        "com.cmbchina.ccd.pluto.cmbActivity",
        "com.coolapk.market",
        "com.ctrip.ct",
        "com.dianping.v1",
        "com.douban.frodo",
        "com.eg.android.AlipayGphone",
        "com.farplace.qingzhuo",
        "com.hanweb.android.zhejiang.activity",
        "com.leoao.fitness",
        "com.lucinhu.bili_you",
        "com.mikrotik.android.tikapp",
        "com.moji.mjweather",
        "com.motorola.cn.calendar",
        "com.motorola.cn.lrhealth",
        "com.netease.cloudmusic",
        "com.sankuai.meituan",
        "com.sina.weibo",
        "com.smartisan.notes",
        "com.sohu.inputmethod.sogou.moto",
        "com.sonelli.juicessh",
        "com.ss.android.article.news",
        "com.ss.android.lark",
        "com.ss.android.ugc.aweme",
        "com.tailscale.ipn",
        "com.taobao.idlefish",
        "com.taobao.taobao",
        "com.tencent.mm",
        "com.tencent.mp",
        "com.tencent.soter.soterserver",
        "com.tencent.wemeet.app",
        "com.tencent.weread",
        "com.tencent.wework",
        "com.ttxapps.wifiadb",
        "com.unionpay",
        "com.unnoo.quan",
        "com.wireguard.android",
        "com.xingin.xhs",
        "com.xunmeng.pinduoduo",
        "com.zui.zhealthy",
        "ctrip.android.view",
        "io.kubenav.kubenav",
        "org.geekbang.geekTime",
        "tv.danmaku.bili"
      ],
      "stack": "mixed",
      "sniff": true
    },
    {
      "type": "socks",
      "tag": "socks-in",
      "listen": "::",
      "listen_port": 5353
    }
  ],
  "outbounds": [
    {
      "type": "selector",
      "tag": "select",
      "outbounds": [
        "trojan-out"
      ],
      "default": "trojan-out"
    },
    {
      "type": "selector",
      "tag": "openai",
      "outbounds": [
        "trojan-out"
      ],
      "default": "trojan-out"
    },
    {
      "type": "selector",
      "tag": "tiktok",
      "outbounds": [
        "trojan-out"
      ],
      "default": "trojan-out"
    },
    {
      "type": "trojan",
      "tag": "trojan-out",
      "server": "199.180.115.155",
      "server_port": 9443,
      "password": "5iFHKMrn9Ez//VKh6zChTA==",
      "tls": {
        "enabled": true,
        "server_name": "ss.icloudnative.io",
        "insecure": true,
        "utls": {
          "fingerprint": "chrome"
        }
      },
      "multiplex": {
        "protocol": "h2mux",
        "max_connections": 4,
        "min_streams": 4
      },
      "transport": {
        "type": "grpc",
        "service_name": "TunService"
      }
    },
    {
      "type": "direct",
      "tag": "direct"
    },
    {
      "type": "block",
      "tag": "block"
    },
    {
      "type": "dns",
      "tag": "dns-out"
    }
  ],
  "route": {
    "rules": [
      {
        "protocol": "dns",
        "outbound": "dns-out"
      },
      {
        "clash_mode": "direct",
        "outbound": "direct"
      },
      {
        "clash_mode": "global",
        "outbound": "select"
      },
      {
        "domain_suffix": [
          "icloudnative.io",
          "fuckcloudnative.io",
          "sealos.io",
          "cdn.jsdelivr.net"
        ],
        "outbound": "direct"
      },
      {
        "process_name": [
          "TencentMeeting",
          "NemoDesktop",
          "ToDesk",
          "ToDesk_Service",
          "WeChat",
          "OpenLens",
          "Tailscale",
          "wireguard-go",
          "Tunnelblick",
          "softwareupdated",
          "kubectl"
        ],
        "outbound": "direct"
      },
      {
        "protocol": "quic",
        "outbound": "block"
      },
      {
        "inbound": "socks-in",
        "outbound": "select"
      },
      {
        "rule_set": [
          "WeChat",
          "Bilibili"
        ],
        "outbound": "direct"
      },
      {
        "rule_set": "OpenAI",
        "outbound": "openai"
      },
      {
        "domain_suffix": [
          "openai.com",
          "oaistatic.com",
          "oaiusercontent.com"
        ],
        "outbound": "openai"
      },
      {
        "package_name": "com.openai.chatgpt",
        "outbound": "openai"
      },
      {
        "rule_set": "TikTok",
        "outbound": "tiktok"
      },
      {
        "package_name": "com.zhiliaoapp.musically",
        "outbound": "tiktok"
      },
      {
        "domain_suffix": [
          "depay.one",
          "orbstack.dev"
        ],
        "outbound": "select"
      },
      {
        "process_name": [
          "DropboxMacUpdate",
          "Dropbox"
        ],
        "outbound": "select"
      },
      {
        "package_name": [
          "com.google.android.youtube",
          "com.android.vending",
          "org.telegram.messenger",
          "org.telegram.plus",
          "com.google.android.googlequicksearchbox",
          "app.rvx.android.youtube",
          "com.mudvod.video",
          "com.fox2code.mmm",
          "com.twitter.android"
        ],
        "outbound": "select"
      },
      {
        "domain": "accounts.google.com",
        "domain_suffix": [
          "sourceforge.net",
          "fhjasokiwq.com"
        ],
        "outbound": "select"
      },
      {
        "domain_suffix": "cloud.sealos.io",
        "outbound": "direct"
      },
      {
        "type": "logical",
        "mode": "and",
        "rules": [
          {
            "rule_set": "geosite-geolocation-!cn"
          },
          {
            "rule_set": "geoip-cn",
            "invert": true
          }
        ],
        "outbound": "select"
      },
      {
        "rule_set": "Global",
        "outbound": "select"
      },
      {
        "rule_set": "geoip-cn",
        "outbound": "direct"
      },
      {
        "ip_is_private": true,
        "outbound": "direct"
      },
      {
        "rule_set": [
          "YouTube",
          "Telegram",
          "Netflix",
          "geoip-google",
          "geoip-telegram",
          "geoip-twitter",
          "geoip-netflix"
        ],
        "outbound": "select"
      }
    ],
    "rule_set": [
      {
        "type": "remote",
        "tag": "geosite-geolocation-!cn",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-geolocation-!cn.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-cn",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-cn.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-google",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-google.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-telegram",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-telegram.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-twitter",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-twitter.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-netflix",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-netflix.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Global",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Global.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "YouTube",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/YouTube.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "OpenAI",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/OpenAI.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "TikTok",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/TikTok.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Telegram",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Telegram.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Netflix",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Netflix.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "WeChat",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/WeChat.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Bilibili",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Bilibili.json",
        "download_detour": "direct"
      }
    ],
    "final": "direct",
    "find_process": true,
    "auto_detect_interface": true
  },
  "experimental": {
    "cache_file": {
      "enabled": true
    },
    "clash_api": {
      "external_controller": "0.0.0.0:9090",
      "external_ui": "metacubexd",
      "external_ui_download_url": "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip",
      "external_ui_download_detour": "select",
      "default_mode": "rule"
    }
  }
}
```
{{< /details >}}

ä¸‹é¢æˆ‘æ¥ç»™å¤§å®¶è§£æä¸€ä¸‹é‡Œé¢çš„é…ç½®ï¼Œé¦–å…ˆæ¥çœ‹ DNS éƒ¨åˆ†ã€‚

{{< alert "bell" >}}
å¦‚æœä½ å«Œä¸‹é¢çš„è§£æå¤ªé•¿ä¸çœ‹ï¼Œé‚£å°±ç›´æ¥ä½¿ç”¨æˆ‘çš„ç¤ºä¾‹æ¨¡æ¿é…ç½®å¥½äº†ã€‚
{{< /alert >}}

### DNS é…ç½®

sing-box å¯¹ DNS çš„å¤„ç†æ¯” Clash å¼ºå¤ªå¤šäº†ï¼Œæ”¯æŒå„ç§åˆ†æµè§„åˆ™ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "dns": {
    "servers": [],
    "rules": [],
    "final": "",
    "strategy": "",
    "disable_cache": false,
    "disable_expire": false,
    "independent_cache": false,
    "reverse_mapping": false,
    "fakeip": {}
  }
}
```

å…¶ä¸­ `servers` å®šä¹‰äº† DNS æœåŠ¡å™¨ï¼Œå…·ä½“å‚æ•°å«ä¹‰æˆ‘å°±ä¸è§£é‡Šäº†ï¼Œè‡ªå·±çœ‹å®˜æ–¹æ–‡æ¡£ã€‚æˆ‘ç»™å‡ºçš„ DNS æœåŠ¡å™¨é…ç½®æ˜¯ï¼š

```json
{
  "dns": {
    "servers": [
      {
        "tag": "dns_proxy",
        "address": "https://1.1.1.1/dns-query",
        "address_resolver": "dns_resolver",
        "strategy": "ipv4_only",
        "detour": "select"
      },
      {
        "tag": "dns_direct",
        "address": "h3://dns.alidns.com/dns-query",
        "address_resolver": "dns_resolver",
        "strategy": "ipv4_only",
        "detour": "direct"
      },
      {
        "tag": "dns_block",
        "address": "rcode://refused"
      },
      {
        "tag": "dns_resolver",
        "address": "223.5.5.5",
        "strategy": "ipv4_only",
        "detour": "direct"
      }
    ]
  }
}
```

è¿™é‡Œå®šä¹‰äº† 3 ä¸ª DNS æœåŠ¡å™¨ï¼Œå½“ä½ å‘èµ·ä¸€ä¸ªåŸŸåè§£æè¯·æ±‚æ—¶ï¼Œè¿™äº›æœåŠ¡å™¨ä¼šè¢«ç”¨æ¥æŸ¥æ‰¾å¯¹åº”çš„ IP åœ°å€ã€‚åŒæ—¶è¿˜å®šä¹‰äº†ä¸€ä¸ª RCode åè®®ç”¨æ¥å±è”½è¯·æ±‚ã€‚

`rules` å®šä¹‰äº† DNS è§„åˆ™ï¼Œè¿™äº›è§„åˆ™ç”¨äºå®šä¹‰å“ªäº›åŸŸååº”è¯¥ä½¿ç”¨å“ªä¸ª DNS æœåŠ¡å™¨è§£æã€‚å®ƒå¯ä»¥è®©ä½ æ ¹æ®åŸŸåçš„ç‰¹å®šæ¨¡å¼é€‰æ‹©ä¸åŒçš„ DNS æœåŠ¡å™¨ã€‚DNS è§„åˆ™å¦‚ä¸‹ï¼š

```json
{
  "dns": {
    "rules": [
      {
        "outbound": "any",
        "server": "dns_resolver"
        // æ³¨é‡Šï¼šå¯¹äºä»»ä½•å‡ºç«™è¿æ¥ï¼ˆä¸ç®¡æ˜¯ç›´æ¥è¿æ¥è¿˜æ˜¯é€šè¿‡ä»£ç†ï¼‰ï¼Œä½¿ç”¨ "dns_resolver" æœåŠ¡å™¨è¿›è¡Œ DNS è§£æï¼ˆè¿™ä¸€å¥ä¸»è¦ç”¨æ¥è§£æä»£ç†èŠ‚ç‚¹æœ¬èº«çš„ IP åœ°å€ï¼‰ã€‚
      },
      {
        "clash_mode": "direct",
        "server": "dns_direct"
        // æ³¨é‡Šï¼šåœ¨ç›´è¿æ¨¡å¼ï¼ˆä¸ç»è¿‡ä»£ç†ï¼‰ä¸‹ï¼Œä½¿ç”¨ "dns_direct" æœåŠ¡å™¨è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "clash_mode": "global",
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šåœ¨å…¨å±€ä»£ç†æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "process_name": [
          "TencentMeeting", "NemoDesktop", "ToDesk", "ToDesk_Service",
          "WeChat", "Tailscale", "wireguard-go", "Tunnelblick",
          "softwareupdated", "kubectl"
        ],
        "server": "dns_direct"
        // æ³¨é‡Šï¼šå½“ç‰¹å®šçš„è¿›ç¨‹ï¼ˆå¦‚ TencentMeetingã€WeChat ç­‰ï¼‰å‘èµ· DNS è¯·æ±‚æ—¶ï¼Œä½¿ç”¨ "dns_direct" æœåŠ¡å™¨è¿›è¡Œç›´è¿ DNS è§£æã€‚
      },
      {
        "domain_suffix": [
          "icloudnative.io", "fuckcloudnative.io", "sealos.io", "cdn.jsdelivr.net"
        ],
        "server": "dns_direct"
        // æ³¨é‡Šï¼šå¯¹äºç‰¹å®šåç¼€çš„åŸŸåï¼ˆå¦‚ icloudnative.io ç­‰ï¼‰ï¼Œä½¿ç”¨ "dns_direct" æœåŠ¡å™¨è¿›è¡Œç›´è¿ DNS è§£æã€‚
      },
      {
        "process_name": ["DropboxMacUpdate", "Dropbox"],
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šå½“ Dropbox ç›¸å…³è¿›ç¨‹å‘èµ· DNS è¯·æ±‚æ—¶ï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨é€šè¿‡ä»£ç†è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "package_name": [
          "com.google.android.youtube", "com.android.vending",
          "org.telegram.messenger", "org.telegram.plus"
        ],
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šå¯¹äºç‰¹å®šçš„ Android åº”ç”¨åŒ…åï¼ˆå¦‚ YouTubeã€Telegram ç­‰ï¼‰ï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨é€šè¿‡ä»£ç†è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "rule_set": "geosite-geolocation-!cn",
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šå¯¹äº geosite æ•°æ®åº“ä¸­å®šä¹‰çš„éä¸­å›½åœ°åŒºçš„åœ°ç†ä½ç½®ç›¸å…³çš„åŸŸåï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨é€šè¿‡ä»£ç†è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "rule_set": "Global",
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šå¯¹äºå®šä¹‰åœ¨ "Global" è§„åˆ™é›†ä¸­çš„åŸŸåï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨é€šè¿‡ä»£ç†è¿›è¡Œ DNS è§£æã€‚
      },
      {
        "rule_set": [
          "YouTube", "Telegram", "Netflix", "geoip-google",
          "geoip-telegram", "geoip-twitter", "geoip-netflix"
        ],
        "server": "dns_proxy"
        // æ³¨é‡Šï¼šå¯¹äºç‰¹å®šçš„æœåŠ¡å’Œåœ°ç†ä½ç½®ç›¸å…³çš„åŸŸåï¼ˆå¦‚ YouTubeã€Netflixã€è°·æ­Œã€Telegram ç›¸å…³çš„åŸŸåï¼‰ï¼Œä½¿ç”¨ "dns_proxy" æœåŠ¡å™¨é€šè¿‡ä»£ç†è¿›è¡Œ DNS è§£æã€‚
      }
    ],
    "final": "dns_direct"
    // æ³¨é‡Šï¼šå¦‚æœä¸Šè¿°è§„åˆ™éƒ½ä¸é€‚ç”¨ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ "dns_direct" æœåŠ¡å™¨è¿›è¡Œç›´è¿ DNS è§£æã€‚
  }
}
```

### å…¥ç«™é…ç½®

æ¥ä¸‹æ¥æ¯”è¾ƒé‡è¦çš„å°±æ˜¯å…¥ç«™è§„åˆ™äº†ï¼Œå…¥ç«™ï¼ˆInboundï¼‰åœ¨ç½‘ç»œé¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åœ¨ä»£ç†å’Œç½‘ç»œè·¯ç”±é…ç½®ä¸­ï¼Œé€šå¸¸æŒ‡çš„æ˜¯è¿›å…¥æŸä¸ªç³»ç»Ÿæˆ–ç½‘ç»œçš„æ•°æ®æµã€‚åœ¨ sing-box ä¸­ï¼Œ**å…¥ç«™é…ç½®å®šä¹‰äº†å¦‚ä½•å¤„ç†è¿›å…¥ä»£ç†æœåŠ¡å™¨çš„æ•°æ®**ã€‚å…¥ç«™é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š

```json
{
  "inbounds": [
    {
      "type": "tun",
      "inet4_address": "198.18.0.1/16",
      "auto_route": true,
      "exclude_package": [
        "cmb.pb",
        "cn.gov.pbc.dcep",
        "com.MobileTicket",
        "com.adguard.android",
        "com.ainemo.dragoon",
        "com.alibaba.android.rimet",
        "com.alicloud.databox",
        "com.amazing.cloudisk.tv",
        "com.autonavi.minimap",
        "com.bilibili.app.in",
        "com.bishua666.luxxx1",
        "com.cainiao.wireless",
        "com.chebada",
        "com.chinamworld.main",
        "com.cmbchina.ccd.pluto.cmbActivity",
        "com.coolapk.market",
        "com.ctrip.ct",
        "com.dianping.v1",
        "com.douban.frodo",
        "com.eg.android.AlipayGphone",
        "com.farplace.qingzhuo",
        "com.hanweb.android.zhejiang.activity",
        "com.leoao.fitness",
        "com.lucinhu.bili_you",
        "com.mikrotik.android.tikapp",
        "com.moji.mjweather",
        "com.motorola.cn.calendar",
        "com.motorola.cn.lrhealth",
        "com.netease.cloudmusic",
        "com.sankuai.meituan",
        "com.sina.weibo",
        "com.smartisan.notes",
        "com.sohu.inputmethod.sogou.moto",
        "com.sonelli.juicessh",
        "com.ss.android.article.news",
        "com.ss.android.lark",
        "com.ss.android.ugc.aweme",
        "com.tailscale.ipn",
        "com.taobao.idlefish",
        "com.taobao.taobao",
        "com.tencent.mm",
        "com.tencent.mp",
        "com.tencent.soter.soterserver",
        "com.tencent.wemeet.app",
        "com.tencent.weread",
        "com.tencent.wework",
        "com.ttxapps.wifiadb",
        "com.unionpay",
        "com.unnoo.quan",
        "com.wireguard.android",
        "com.xingin.xhs",
        "com.xunmeng.pinduoduo",
        "com.zui.zhealthy",
        "ctrip.android.view",
        "io.kubenav.kubenav",
        "org.geekbang.geekTime",
        "tv.danmaku.bili"
      ],
      "stack": "mixed",
      "sniff": true
    },
    {
      "type": "socks",
      "tag": "socks-in",
      "listen": "::",
      "listen_port": 5353
    }
  ]
}
```

ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªå­—æ®µçš„è¯¦ç»†æ³¨é‡Šï¼š

ç¬¬ä¸€ä¸ªå…¥ç«™è¿æ¥çš„é…ç½®ï¼š

- **`type`**: `"tun"` è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª tun è™šæ‹Ÿç½‘ç»œæ¥å£çš„é…ç½®ã€‚
- **`inet4_address`**: `"198.18.0.1/16"` è®¾å®šäº†è™šæ‹Ÿç½‘ç»œæ¥å£çš„ IPv4 åœ°å€å’Œå­ç½‘æ©ç ã€‚
- **`auto_route`**: `true` è¡¨ç¤ºå°†è‡ªåŠ¨å¤„ç†è·¯ç”±ï¼Œç¡®ä¿æ•°æ®åŒ…æ­£ç¡®ä¼ è¾“ã€‚
- **`exclude_package`**: è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†ä¸é€šè¿‡æ­¤è™šæ‹Ÿç½‘ç»œæ¥å£å¤„ç†çš„ Android åº”ç”¨ç¨‹åºåŒ…ååˆ—è¡¨ã€‚**åˆ—å‡ºçš„ Android åº”ç”¨ç¨‹åºå°†ä½¿ç”¨å¸¸è§„ç½‘ç»œæ¥å£è€Œä¸æ˜¯è™šæ‹Ÿæ¥å£**ã€‚
- **`stack`**: `"mixed"` è¡¨ç¤ºæ··åˆ `system` TCP æ ˆä¸ `gvisor` UDP æ ˆã€‚
- **`sniff`**: `true` è¡¨ç¤ºå¯ç”¨æµé‡å—…æ¢åŠŸèƒ½ï¼Œä»¥ä¾¿è‡ªåŠ¨æ£€æµ‹å’Œå¤„ç†ä¼ å…¥çš„æ•°æ®æµç±»å‹ã€‚

ç¬¬äºŒä¸ªå…¥ç«™è¿æ¥çš„é…ç½®ï¼š

- **`type`**: `"socks"` è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª SOCKS ä»£ç†é…ç½®ã€‚
- **`tag`**: `"socks-in"` ä¸ºè¿™ä¸ªå…¥ç«™è¿æ¥å®šä¹‰äº†ä¸€ä¸ªæ ‡ç­¾ï¼Œæ–¹ä¾¿åœ¨å…¶å®ƒé…ç½®ä¸­å¼•ç”¨ã€‚
- **`listen`**: `"::"` è¡¨ç¤ºç›‘å¬æ‰€æœ‰ IPv6 åœ°å€ã€‚å¦‚æœéœ€è¦ç›‘å¬æ‰€æœ‰ IPv4 åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ `"0.0.0.0"`ã€‚
- **`listen_port`**: `5353` å®šä¹‰äº† SOCKS ä»£ç†ç›‘å¬çš„ç«¯å£å·ã€‚

å…¶ä¸­ tun æ¥å£æ˜¯æ ¸å¿ƒéƒ¨åˆ†ï¼Œ**æˆ‘ä»¬å°†åˆ©ç”¨ tun æ¥å£æ¥å®ç°å…¨å±€é€æ˜ä»£ç†**ã€‚

### å‡ºç«™é…ç½®

å‡ºç«™ï¼ˆOutboundï¼‰æ˜¯æŒ‡ä»æœ¬åœ°ç½‘ç»œæˆ–è®¾å¤‡å‘å‡ºï¼Œå‘å¤–éƒ¨ç½‘ç»œã€æœåŠ¡æˆ–äº’è”ç½‘å‘é€çš„æ•°æ®æµé‡ã€‚ç¤ºä¾‹å‡ºç«™é…ç½®å¦‚ä¸‹ï¼š

```json
{
  "outbounds": [
    {
      "type": "selector", // ç±»å‹ä¸ºé€‰æ‹©å™¨ï¼Œç”¨äºåœ¨å¤šä¸ªå‡ºç«™ä¸­é€‰æ‹©ä¸€ä¸ª
      "tag": "select", // æ ‡ç­¾åä¸º "select"
      "outbounds": [
        "trojan-out" // å¯é€‰æ‹©çš„å‡ºç«™åˆ—è¡¨ï¼Œè¿™é‡Œåªæœ‰ "trojan-out"
      ],
      "default": "trojan-out" // é»˜è®¤é€‰æ‹©çš„å‡ºç«™ä¸º "trojan-out"
    },
    {
      "type": "selector", // åŒæ ·æ˜¯é€‰æ‹©å™¨ç±»å‹
      "tag": "openai", // æ ‡ç­¾åä¸º "openai"
      "outbounds": [
        "trojan-out" // å¯é€‰æ‹©çš„å‡ºç«™ä»ç„¶æ˜¯ "trojan-out"
      ],
      "default": "trojan-out" // é»˜è®¤é€‰æ‹©çš„å‡ºç«™åŒæ ·æ˜¯ "trojan-out"
    },
    {
      "type": "selector", // é€‰æ‹©å™¨ç±»å‹
      "tag": "tiktok", // æ ‡ç­¾åä¸º "tiktok"
      "outbounds": [
        "trojan-out" // å¯é€‰æ‹©çš„å‡ºç«™æ˜¯ "trojan-out"
      ],
      "default": "trojan-out" // é»˜è®¤é€‰æ‹©çš„å‡ºç«™ä¸º "trojan-out"
    },
    {
      "type": "trojan", // ç±»å‹ä¸º Trojan
      "tag": "trojan-out", // æ ‡ç­¾åä¸º "trojan-out"
      "server": "xxxxxxxx", // Trojan æœåŠ¡å™¨åœ°å€
      "server_port": 9443, // Trojan æœåŠ¡å™¨ç«¯å£
      "password": "xxxxxxxx", // Trojan è¿æ¥å¯†ç 
      "tls": {
        "enabled": true, // å¯ç”¨ TLS åŠ å¯†
        "server_name": "xxxxxxxx", // TLS æœåŠ¡å™¨åç§°
        "insecure": true, // ä¸éªŒè¯ TLS è¯ä¹¦ï¼Œç”¨äºè‡ªç­¾åè¯ä¹¦
        "utls": {
          "fingerprint": "chrome" // ä½¿ç”¨ Chrome çš„ TLS æŒ‡çº¹
        }
      },
      "multiplex": {
        "protocol": "h2mux", // ä½¿ç”¨ h2mux å¤šè·¯å¤ç”¨åè®®
        "max_connections": 4, // æœ€å¤§è¿æ¥æ•°ä¸º 4
        "min_streams": 4 // æ¯ä¸ªè¿æ¥çš„æœ€å°æµæ•°ä¸º 4
      },
      "transport": {
        "type": "grpc", // ä¼ è¾“åè®®ä¸º gRPC
        "service_name": "TunService" // gRPC æœåŠ¡åç§°
      }
    },
    {
      "type": "direct", // ç›´è¿ç±»å‹ï¼Œä¸é€šè¿‡ä»£ç†ç›´æ¥è®¿é—®
      "tag": "direct" // æ ‡ç­¾åä¸º "direct"
    },
    {
      "type": "block", // é˜»æ­¢ç±»å‹ï¼Œç”¨äºæ‹¦æˆªæµé‡
      "tag": "block" // æ ‡ç­¾åä¸º "block"
    },
    {
      "type": "dns", // DNS ç±»å‹ï¼Œç”¨äº DNS æŸ¥è¯¢
      "tag": "dns-out" // æ ‡ç­¾åä¸º "dns-out"
    }
  ]
}
```

è¿™ä¸ªé…ç½®å®šä¹‰äº†ä¸åŒç±»å‹çš„å‡ºç«™è¿æ¥æ–¹å¼ï¼ŒåŒ…æ‹¬é€‰æ‹©å™¨ã€Trojanã€ç›´è¿ã€é˜»æ­¢å’Œ DNS ç±»å‹ã€‚æ¯ç§ç±»å‹éƒ½é€šè¿‡æ ‡ç­¾è¿›è¡Œæ ‡è¯†ï¼Œä¾¿äºåœ¨åç»­çš„è·¯ç”±è§„åˆ™ä¸­å¼•ç”¨ã€‚

### è·¯ç”±é…ç½®

è·¯ç”±éƒ¨åˆ†æ‰æ˜¯ sing-box çš„æ ¸å¿ƒé…ç½®ï¼Œè¿™ä¸ªéƒ¨åˆ†å®šä¹‰äº†ä¸€ç³»åˆ—è§„åˆ™å’Œå‚æ•°ï¼Œç”¨äºå†³å®šå¦‚ä½•å¤„ç†ä¸åŒçš„ç½‘ç»œè¯·æ±‚ã€‚é€šè¿‡è¿™äº›è§„åˆ™å’Œå‚æ•°ï¼Œsing-box å¯ä»¥éå¸¸çµæ´»åœ°å¤„ç†å¤æ‚çš„è·¯ç”±éœ€æ±‚ï¼ŒåŒ…æ‹¬åŸºäºåœ°ç†ä½ç½®ã€IP åœ°å€ã€ç«¯å£å·ã€åŸŸåç­‰å¤šç§æ¡ä»¶çš„æµé‡åˆ†æµã€‚é…ç½®ç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "route": {
    "rules": [],
    "rule_set": [],
    "final": "direct", // "final" å­—æ®µå®šä¹‰äº†é»˜è®¤çš„è·¯ç”±è¡Œä¸ºã€‚è¿™é‡Œè®¾ç½®ä¸º "direct"ï¼Œæ„å‘³ç€å¦‚æœæ²¡æœ‰åŒ¹é…ä»»ä½•è§„åˆ™ï¼Œæµé‡å°†ç›´æ¥ï¼ˆä¸ç»ä»£ç†ï¼‰å‘é€ã€‚
    "auto_detect_interface": true // è¡¨ç¤ºè‡ªåŠ¨æ£€æµ‹ç½‘ç»œæ¥å£ã€‚è¿™æœ‰åŠ©äºè‡ªåŠ¨é€‚åº”ç½‘ç»œå˜åŒ–ï¼Œç¡®ä¿è·¯ç”±æ­£ç¡®ã€‚
  }
}
```

å…¶ä¸­çš„æ ¸å¿ƒé…ç½®ï¼š

1. **è·¯ç”±è§„åˆ™ (`rules`)**: è¿™äº›è§„åˆ™å®šä¹‰äº†å¦‚ä½•æ ¹æ®ä¸åŒçš„æ¡ä»¶å°†æµé‡å®šå‘åˆ°ä¸åŒçš„å‡ºç«™è¿æ¥ã€‚æ¯ä¸ªè§„åˆ™å¯ä»¥åŒ…æ‹¬å¤šä¸ªæ¡ä»¶ï¼Œå¦‚åŸŸåã€IP åœ°å€ã€ç«¯å£å·ã€ç½‘ç»œåè®®ç­‰ã€‚
2. **è§„åˆ™é›† (`rule_set`)**: ä» sing-box 1.8.0 ç‰ˆæœ¬å¼€å§‹ï¼Œè§„åˆ™å¯ä»¥ç»„åˆæˆè§„åˆ™é›†ï¼Œè¿™ä½¿å¾—é…ç½®æ›´åŠ çµæ´»å’Œæ¨¡å—åŒ–ã€‚

#### è·¯ç”±è§„åˆ™

ä»¥ä¸‹æ˜¯æˆ‘ç»™å‡ºçš„è·¯ç”±è§„åˆ™ç¤ºä¾‹ï¼š

```json
{
  "route": {
    "rules": [
      {
        "protocol": "dns",        // ä½¿ç”¨DNSåè®®çš„æµé‡
        "outbound": "dns-out"     // å°†é€šè¿‡'dns-out'å‡ºå£è½¬å‘
      },
      {
        "clash_mode": "direct",   // Clashæ¨¡å¼ä¸ºç›´è¿
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "clash_mode": "global",   // Clashæ¨¡å¼ä¸ºå…¨å±€
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "domain_suffix": [        // ç‰¹å®šåç¼€çš„åŸŸå
          "icloudnative.io",
          "fuckcloudnative.io",
          "sealos.io",
          "cdn.jsdelivr.net"
        ],
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "process_name": [         // ç‰¹å®šè¿›ç¨‹åç§°
          "TencentMeeting",
          "NemoDesktop",
          ...
        ],
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "rule_set": [             // ç‰¹å®šçš„è§„åˆ™é›†
          "WeChat",
          "Bilibili"
        ],
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "protocol": "quic",       // ä½¿ç”¨QUICåè®®çš„æµé‡
        "outbound": "block"       // å°†è¢«é˜»æ­¢
      },
      {
        "inbound": "socks-in",    // æ¥è‡ª'socks-in'å…¥å£çš„æµé‡
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "rule_set": "OpenAI",     // OpenAIè§„åˆ™é›†
        "outbound": "openai"      // å°†é€šè¿‡'openai'å‡ºå£è½¬å‘
      },
      {
        "domain_suffix": [        // OpenAIç›¸å…³çš„åŸŸååç¼€
          "openai.com",
          "oaistatic.com",
          "oaiusercontent.com"
        ],
        "outbound": "openai"      // å°†é€šè¿‡'openai'å‡ºå£è½¬å‘
      },
      {
        "package_name": "com.openai.chatgpt", // OpenAI ChatGPTåº”ç”¨åŒ…å
        "outbound": "openai"                  // å°†é€šè¿‡'openai'å‡ºå£è½¬å‘
      },
      {
        "rule_set": "TikTok",     // TikTokè§„åˆ™é›†
        "outbound": "tiktok"      // å°†é€šè¿‡'tiktok'å‡ºå£è½¬å‘
      },
      {
        "package_name": "com.zhiliaoapp.musically", // TikTokåº”ç”¨åŒ…å
        "outbound": "tiktok"                          // å°†é€šè¿‡'tiktok'å‡ºå£è½¬å‘
      },
      {
        "domain_suffix": [        // ç‰¹å®šçš„åŸŸååç¼€
          "depay.one",
          "orbstack.dev"
        ],
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "process_name": [         // ç‰¹å®šçš„è¿›ç¨‹åç§°
          "DropboxMacUpdate",
          "Dropbox"
        ],
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "package_name": [         // ç‰¹å®šåº”ç”¨åŒ…å
          "com.google.android.youtube",
          ...
        ],
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "domain": "accounts.google.com", // ç‰¹å®šçš„åŸŸå
        "domain_suffix": [               // ç‰¹å®šçš„åŸŸååç¼€
          "sourceforge.net",
          "fhjasokiwq.com"
        ],
        "outbound": "select"             // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "domain_suffix": "cloud.sealos.io", // ç‰¹å®šçš„åŸŸååç¼€
        "outbound": "direct"                // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "type": "logical",        // é€»è¾‘ç±»å‹è§„åˆ™
        "mode": "and",            // ä½¿ç”¨'and'æ¨¡å¼
        "rules": [                // ç»„åˆè§„åˆ™
          {
            "rule_set": "geosite-geolocation-!cn"
          },
          {
            "rule_set": "geoip-cn",
            "invert": true
          }
        ],
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "rule_set": "Global",     // Globalè§„åˆ™é›†
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      },
      {
        "rule_set": "geoip-cn",   // ä¸­å›½åœ°ç†ä½ç½®IPè§„åˆ™é›†
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "ip_is_private": true,    // ç§æœ‰IPåœ°å€
        "outbound": "direct"      // å°†é€šè¿‡'direct'å‡ºå£ç›´æ¥è¿æ¥
      },
      {
        "rule_set": [             // ç‰¹å®šçš„è§„åˆ™é›†
          "YouTube",
          "Telegram",
          "Netflix",
          "geoip-google",
          "geoip-telegram",
          "geoip-twitter",
          "geoip-netflix"
        ],
        "outbound": "select"      // å°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      }
    ]
  }
}
```

è¿™ä¸ªé…ç½®å®šä¹‰äº†ä¸åŒç±»å‹çš„æµé‡ï¼ˆå¦‚åŸºäºåè®®ã€åŸŸååç¼€ã€åº”ç”¨åŒ…åã€è¿›ç¨‹åç§°ç­‰ï¼‰å¦‚ä½•è¢«è·¯ç”±ã€‚æ¯æ¡è§„åˆ™éƒ½æŒ‡å®šäº†ä¸€ç§æµé‡ç±»å‹å’Œç›¸åº”çš„â€œå‡ºå£â€ï¼Œå³æµé‡åº”è¯¥å¦‚ä½•è¢«å¤„ç†æˆ–è½¬å‘ã€‚è¿™ç§çµæ´»çš„è·¯ç”±é…ç½®å¯ä»¥éå¸¸ç²¾ç¡®åœ°æ§åˆ¶ç½‘ç»œæµé‡ã€‚

#### è§„åˆ™é›†

ä»¥ä¸‹æ˜¯æˆ‘ç»™å‡ºçš„è§„åˆ™é›†ç¤ºä¾‹ï¼š

```json
{
  "route": {
    "rule_set": [
      {
        "type": "remote",
        "tag": "geosite-geolocation-!cn",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-geolocation-!cn.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-cn",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-cn.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-google",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-google.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-telegram",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-telegram.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-twitter",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-twitter.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "geoip-netflix",
        "format": "binary",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/CHIZI-0618/v2ray-rules-dat/release/singbox_ip_rule_set/geoip-netflix.srs",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Global",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Global.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "YouTube",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/YouTube.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "OpenAI",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/OpenAI.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "TikTok",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/TikTok.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Telegram",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Telegram.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Netflix",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Netflix.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "WeChat",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/WeChat.json",
        "download_detour": "direct"
      },
      {
        "type": "remote",
        "tag": "Bilibili",
        "format": "source",
        "url": "https://mirror.ghproxy.com/https://raw.githubusercontent.com/yangchuansheng/sing-box-geosite/main/rule/Bilibili.json",
        "download_detour": "direct"
      }
    ]
  }
}
```

è¿™é‡Œæœ‰ä¸¤ç§ä¸åŒç±»å‹çš„è§„åˆ™é›†ï¼Œä¸€ç§æ˜¯ binaryï¼Œå¦å¤–ä¸€ç§æ˜¯ sourceã€‚binary è§„åˆ™é›†ä¸€èˆ¬éƒ½æ˜¯åˆ©ç”¨ GEOSITE æˆ–è€… GEOIP ç›´æ¥ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶è§„åˆ™ï¼Œå®ƒä»¬è¢«ç›´æ¥åµŒå…¥åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚è€Œ source è§„åˆ™é›†å°±å’Œ Clash çš„ ruleset æ¯”è¾ƒç±»ä¼¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œè€Œä¸æ˜¯äºŒè¿›åˆ¶ã€‚

ç›®å‰å·²ç»æœ‰ç›¸å…³é¡¹ç›®å¯ä»¥è‡ªåŠ¨å°†ç½‘ç»œä¸Šçš„ Clash Ruleset è§„åˆ™è‡ªåŠ¨è½¬æ¢ä¸º sing-box çš„ source è§„åˆ™é›†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒè¿™ä¸ªé¡¹ç›®ï¼š[sing-box-geosite](https://github.com/Toperlock/sing-box-geosite)

### Clash API

æœ€åçš„å®éªŒæ€§é…ç½®ç”¨æ¥å¼€å¯ Clash APIã€‚æ²¡é”™ï¼Œsing-box æ˜¯å…¼å®¹ Clash API æ»´ï¼é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Clash çš„ dashboard æ¥ç®¡ç† sing-box äº†ï¼Œç›´æ¥ç”¨è¿™ä¸ªé¡¹ç›®å¥½äº†ï¼š[metacubexd](https://github.com/MetaCubeX/metacubexd)

ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š

```json
{
  "experimental": {
    "cache_file": {
      "enabled": true  // å¯ç”¨ç¼“å­˜æ–‡ä»¶åŠŸèƒ½ã€‚å½“æ­¤é¡¹è®¾ç½®ä¸ºtrueæ—¶ï¼Œå¯ç”¨ DNS æŸ¥è¯¢çš„ç¼“å­˜ï¼Œä»¥ä¾¿åŠ å¿«åç»­ç›¸åŒæŸ¥è¯¢çš„å“åº”é€Ÿåº¦ã€‚
    },
    "clash_api": {
      "external_controller": "0.0.0.0:9090",  // å®šä¹‰ Clash API çš„å¤–éƒ¨æ§åˆ¶å™¨åœ°å€ã€‚"0.0.0.0:9090" è¡¨ç¤ºåœ¨æœ¬æœºçš„9090ç«¯å£ä¸Šç›‘å¬å¤–éƒ¨çš„è¿æ¥è¯·æ±‚ã€‚
      "external_ui": "metacubexd",  // æŒ‡å®šå¤–éƒ¨ç”¨æˆ·ç•Œé¢(UI)çš„åç§°ã€‚è¿™é‡Œçš„ "metacubexd" æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ UI çš„åç§°ã€‚
      "external_ui_download_url": "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip",  // æä¾›å¤–éƒ¨ UI çš„ä¸‹è½½ URLã€‚è¿™ä¸ª URL æ˜¯ä» GitHub ä¸Šä¸‹è½½ "metacubexd" UI çš„å‹ç¼©åŒ…ã€‚
      "external_ui_download_detour": "select",  // å®šä¹‰ä¸‹è½½å¤–éƒ¨ UI æ—¶ä½¿ç”¨çš„è½¬å‘ç­–ç•¥ã€‚"select" è¡¨ç¤ºå°†é€šè¿‡'select'å‡ºå£é€‰æ‹©è½¬å‘
      "default_mode": "rule"  // è®¾ç½® Clash API çš„é»˜è®¤æ¨¡å¼ã€‚"rule" æ¨¡å¼æ„å‘³ç€æµé‡å°†æ ¹æ®ç”¨æˆ·å®šä¹‰çš„è§„åˆ™è¿›è¡Œè·¯ç”±ã€‚
    }
  }
}
```

æœ€ç»ˆå¯åŠ¨ sing-box ä¹‹åå°±å¯ä»¥é€šè¿‡ Clash dashboard æ¥æŸ¥çœ‹å’Œç®¡ç†æµé‡å•¦ï¼š

![](https://images.icloudnative.io/uPic/2024-01-14-17-16-2yLPXT.webp)

{{< alert >}}
**æ³¨æ„ï¼š** å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨æŠŠå¤–éƒ¨æ§åˆ¶å™¨ç›¸å…³çš„é…ç½®ç»™å±è”½æ‰ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ Dashboardï¼Œåªèƒ½ä½¿ç”¨å‘½ä»¤è¡Œæ¥å¯åŠ¨ sing-boxã€‚
{{< /alert >}}

## è®¢é˜…è½¬æ¢

æˆ‘æƒ³å¤§éƒ¨åˆ†å°ä¼™ä¼´ä½¿ç”¨çš„è¿˜æ˜¯è®¢é˜…é“¾æ¥ï¼Œä¸å¯èƒ½å‚»ä¹ä¹çš„è‡ªå·±å†™é…ç½®å’Œè§„åˆ™ã€‚ä½†æ˜¯ç›®å‰å¤§éƒ¨åˆ†jiåœºéƒ½ä¸æä¾› sing-box çš„é…ç½®æ ¼å¼ï¼Œä»…æœ‰å°‘é‡jiåœºæä¾›æ”¯æŒï¼Œå…¶ä»–jiåœºå¯ä½¿ç”¨ä¸‹é¢è¿™ä¸ªé¡¹ç›®å°†å¸¸è§è®¢é˜…è½¬æ¢ä¸º sing-box è®¢é˜…æ ¼å¼ï¼š[sing-box-subscribe](https://github.com/Toperlock/sing-box-subscribe)

ä½ å¯ä»¥å°†è¿™ä¸ªé¡¹ç›®éƒ¨ç½²åˆ°è‡ªå·±çš„ Vercel ä¸­ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹çš„é“¾æ¥æ ¼å¼æ¥å°†å¸¸è§è®¢é˜…è½¬æ¢ä¸º sing-box è®¢é˜…æ ¼å¼ï¼š

```bash
<URL>/url=<subscription_url>/&file=<sing-box_template_url>
```

+ `<URL>`ï¼šè¿™æ˜¯ä½ çš„ sing-box-subscribe è®¿é—®é“¾æ¥ï¼›
+ `<subscription_url>`ï¼šè¿™æ˜¯ä½ çš„è®¢é˜…é“¾æ¥ï¼›
+ `<sing-box_template_url>`ï¼šè¿™æ˜¯ä½ çš„ sing-box æ¨¡æ¿é…ç½®é“¾æ¥ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨[æˆ‘çš„æ¨¡æ¿](https://gist.githubusercontent.com/yangchuansheng/5182974442015feeeeb058de543a00fd/raw/45b11ff08188af021da98e7174923d719dc42dd9/gistfile1.txt)ã€‚

ä¾‹å¦‚ï¼š

```bash
https://sing-box-subscribe.vercel.app/config/url=https://xxxxxx?clash=1/&file=https://gist.githubusercontent.com/yangchuansheng/5182974442015feeeeb058de543a00fd/raw/45b11ff08188af021da98e7174923d719dc42dd9/gistfile1.txt
```

å¦‚æœä½ æœ‰å¤šä¸ªè®¢é˜…é“¾æ¥ï¼Œéœ€è¦å…ˆå°†è®¢é˜…é“¾æ¥åˆå¹¶ä¸ºä¸€ä¸ªé“¾æ¥ï¼Œç„¶åå†è¿›è¡Œè½¬æ¢ï¼Œå…·ä½“çœ‹å‚è€ƒ [sing-box-subscribe çš„å®˜æ–¹æ–‡æ¡£](https://github.com/Toperlock/sing-box-subscribe/blob/main/instructions/README.md)ã€‚

## æ›´å¤šé…ç½®ç¤ºä¾‹

æ›´å¤šçš„é…ç½®ç¤ºä¾‹å¯ä»¥å‚è€ƒè¿™ä¸ªé¡¹ç›®ï¼š[sing-box-examples](https://github.com/chika0801/sing-box-examples)

è¿™ä¸ªé¡¹ç›®é’ˆå¯¹æ¯ä¸€ä¸ªä»£ç†åè®®éƒ½æä¾›äº†è¯¦ç»†çš„é…ç½®ç¤ºä¾‹ï¼Œè¿˜æœ‰å¾ˆå¤šçš„éªšæ“ä½œï¼Œæ¯”å¦‚[å°† Cloudflare çš„ Warp èŠ‚ç‚¹ä¿¡æ¯ç›´æ¥æå–å‡ºæ¥åŠ åˆ° sing-box å‡ºç«™é…ç½®ä¸­å»](https://github.com/chika0801/sing-box-examples/blob/main/wireguard.md)ï¼Œå¦™å•Šï¼

## é€æ˜ç½‘å…³

å¦‚æœä½ æƒ³è®©å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰æœºå™¨éƒ½èƒ½å¤Ÿæ ¹æ®è§„åˆ™æ™ºèƒ½åˆ†æµï¼Œé‚£å°±åœ¨å±€åŸŸç½‘ä¸­æ‰¾ä¸€å°æœºå™¨ä½œä¸ºé€æ˜ç½‘å…³ï¼Œåœ¨è¿™å°æœºå™¨ä¸Šè¿è¡Œä¸€ä¸ª sing-box å°±è¡Œäº†ï¼Œä¸éœ€è¦åƒ Clash ä¸€æ ·å†™ä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„ iptables è§„åˆ™ï¼Œç›´æ¥ä¸€ä¸ªé…ç½®æ–‡ä»¶å°±è¡Œäº†ï¼Œéå¸¸ç®€å•ã€‚é€šå¸¸æˆ‘ä»¬ä½¿ç”¨è½¯è·¯ç”±æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œå¦‚æœä½ ä¸æƒ³ä½¿ç”¨è½¯è·¯ç”±ï¼Œé‚£éšä¾¿æ‰¾ä¸€å°æœºå™¨å°±è¡Œäº†ï¼Œå½“ç„¶æœ€å¥½è¿˜æ˜¯ä½¿ç”¨ Linux æ¯”è¾ƒé è°±ã€‚

åœ¨ç½‘å…³ä¸Šè¿è¡Œ sing-box ä¹‹åï¼Œå…¶ä»–æœºå™¨åªéœ€è¦å°†ç½‘å…³æŒ‡å‘è¿™å°æœºå™¨ï¼Œä¾¿å¯ä»¥æ— ç—›å¼€å¯é­”æ³•æ™ºèƒ½åˆ†æµäº†ã€‚

{{< alert >}}
**æ³¨æ„ï¼š** å…¶ä»–æœºå™¨çš„ DNS å¿…é¡»æ˜¯å…¬ç½‘ DNSï¼Œä¸èƒ½ä½¿ç”¨å†…ç½‘ DNSï¼ä½ çš„ DNS å¯ä»¥æŒ‡å‘ä»»æ„çš„å…¬ç½‘ DNSï¼Œåæ­£åªè¦æ˜¯å…¬ç½‘å°±è¡Œï¼Œæ¯”å¦‚ï¼š114.114.114.114ï¼Œå› ä¸º sing-box ä¼šåŠ«æŒå±€åŸŸç½‘ä¸­çš„æ‰€æœ‰ DNS è¯·æ±‚ã€‚
{{< /alert >}}

å½“ç„¶ï¼Œå¦‚æœä½ ä¸æƒ³è®© sing-box åŠ«æŒå±€åŸŸç½‘ä¸­çš„æ‰€æœ‰ DNS è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ¡ˆï¼š

é¦–å…ˆåœ¨å…¥ç«™é…ç½®ä¸­æ·»åŠ ä¸€ä¸ªç›‘å¬ç«¯å£ï¼š

```json
{
  "inbounds": [
    {
      "type": "direct",
      "tag": "dns-in",
      "listen": "0.0.0.0",
      "listen_port": 53
    }
  ]
}
```

ç„¶ååœ¨è·¯ç”±è§„åˆ™ä¸­å°† DNS çš„è§„åˆ™æ”¹æˆå¦‚ä¸‹çš„é…ç½®ï¼š

```json
{
  "route": {
    "rules": [
      {
        "inbound": "dns-in",
        "outbound": "dns-out"
      }
    ]
  }
}
```

è¿™æ ·å°±ä¿è¯äº†åªæœ‰ä» 53 ç«¯å£è¿›æ¥çš„æµé‡æ‰ä¼šè¿›å…¥ DNS è§£æã€‚

é‡å¯ç”Ÿæ•ˆåï¼Œå°†å…¶ä»–æœºå™¨çš„ç½‘å…³å’Œ DNS å‡æŒ‡å‘è¿™å°æœºå™¨å°±å¯ä»¥äº†ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ DHCPï¼Œåªéœ€è¦åœ¨ DHCP æœåŠ¡å™¨ä¸­å°† DHCP åˆ†é…çš„ç½‘å…³å’Œ DNS æ”¹æˆ sing-box æ‰€åœ¨çš„æœºå™¨ IP å³å¯ã€‚